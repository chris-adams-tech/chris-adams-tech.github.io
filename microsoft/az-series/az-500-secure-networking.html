<!DOCTYPE html> <html><head>
		<title>AZ-500 Secure Networking</title>
		<base href="..\../">
		<meta id="root-path" root-path="..\../">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0">
		<meta charset="UTF-8">
		<meta name="description" content="Table of Contents - Chris Adams - AZ-500 Secure Networking">
		<meta property="og:title" content="AZ-500 Secure Networking">
		<meta property="og:description" content="Table of Contents - Chris Adams - AZ-500 Secure Networking">
		<meta property="og:type" content="website">
		<meta property="og:url" content="https://chris-adams-tech.github.io/microsoft/az-series/az-500-secure-networking.html">
		<meta property="og:image" content="https://twemoji.maxcdn.com/v/13.1.0/72x72/2705.png">
		<meta property="og:site_name" content="Table of Contents - Chris Adams">
		<meta name="author" content="Chris Adams"><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="https://chris-adams-tech.github.io/lib/rss.xml"><script async="" id="webpage-script" src="lib/scripts/webpage.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script type="module" async="" id="graph-view-script" src="lib/scripts/graph-view.js"></script><script async="" id="graph-wasm-script" src="lib/scripts/graph-wasm.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="graph-render-worker-script" src="lib/scripts/graph-render-worker.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="tinycolor-script" src="lib/scripts/tinycolor.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="pixi-script" src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/7.4.0/pixi.min.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="minisearch-script" src="https://cdn.jsdelivr.net/npm/minisearch@6.3.0/dist/umd/index.min.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><link rel="icon" href="lib/media/favicon.png"><script async="" id="graph-data-script" src="lib/scripts/graph-data.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><style>body{--line-width:40em;--line-width-adaptive:40em;--file-line-width:40em;--sidebar-width:min(20em, 80vw);--collapse-arrow-size:11px;--tree-horizontal-spacing:0.6em;--tree-vertical-spacing:0.6em;--sidebar-margin:12px}.sidebar{height:100%;min-width:calc(var(--sidebar-width) + var(--divider-width-hover));max-width:calc(var(--sidebar-width) + var(--divider-width-hover));font-size:14px;z-index:10;position:relative;overflow:hidden;transition:min-width ease-in-out,max-width ease-in-out;transition-duration:.2s;contain:size}.sidebar-left{left:0}.sidebar-right{right:0}.sidebar.is-collapsed{min-width:0;max-width:0}body.floating-sidebars .sidebar{position:absolute}.sidebar-content{height:100%;min-width:calc(var(--sidebar-width) - var(--divider-width-hover));top:0;padding:var(--sidebar-margin);padding-top:4em;line-height:var(--line-height-tight);background-color:var(--background-secondary);transition:background-color,border-right,border-left,box-shadow;transition-duration:var(--color-fade-speed);transition-timing-function:ease-in-out;position:absolute;display:flex;flex-direction:column}.sidebar:not(.is-collapsed) .sidebar-content{min-width:calc(max(100%,var(--sidebar-width)) - 3px);max-width:calc(max(100%,var(--sidebar-width)) - 3px)}.sidebar-left .sidebar-content{left:0;border-top-right-radius:var(--radius-l);border-bottom-right-radius:var(--radius-l)}.sidebar-right .sidebar-content{right:0;border-top-left-radius:var(--radius-l);border-bottom-left-radius:var(--radius-l)}.sidebar:has(.sidebar-content:empty):has(.topbar-content:empty){display:none}.sidebar-topbar{height:2em;width:var(--sidebar-width);top:var(--sidebar-margin);padding-inline:var(--sidebar-margin);z-index:1;position:fixed;display:flex;align-items:center;transition:width ease-in-out;transition-duration:inherit}.sidebar.is-collapsed .sidebar-topbar{width:calc(2.3em + var(--sidebar-margin) * 2)}.sidebar .sidebar-topbar.is-collapsed{width:0}.sidebar-left .sidebar-topbar{left:0}.sidebar-right .sidebar-topbar{right:0}.topbar-content{overflow:hidden;overflow:clip;width:100%;height:100%;display:flex;align-items:center;transition:inherit}.sidebar.is-collapsed .topbar-content{width:0;transition:inherit}.clickable-icon.sidebar-collapse-icon{background-color:transparent;color:var(--icon-color-focused);padding:0!important;margin:0!important;height:100%!important;width:2.3em!important;margin-inline:0.14em!important;position:absolute}.sidebar-left .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);right:var(--sidebar-margin)}.sidebar-right .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);left:var(--sidebar-margin)}.clickable-icon.sidebar-collapse-icon svg.svg-icon{width:100%;height:100%}.sidebar-section-header{margin:0 0 1em 0;text-transform:uppercase;letter-spacing:.06em;font-weight:600}body{transition:background-color var(--color-fade-speed) ease-in-out}.webpage-container{display:flex;flex-direction:row;height:100%;width:100%;align-items:stretch;justify-content:center}.document-container{opacity:1;flex-basis:100%;max-width:100%;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;transition:opacity .2s ease-in-out;contain:inline-size}.hide{opacity:0;transition:opacity .2s ease-in-out}.document-container>.markdown-preview-view{margin:var(--sidebar-margin);margin-bottom:0;width:100%;width:-webkit-fill-available;width:-moz-available;width:fill-available;background-color:var(--background-primary);transition:background-color var(--color-fade-speed) ease-in-out;border-top-right-radius:var(--window-radius,var(--radius-m));border-top-left-radius:var(--window-radius,var(--radius-m));overflow-x:hidden!important;overflow-y:auto!important;display:flex!important;flex-direction:column!important;align-items:center!important;contain:inline-size}.document-container>.markdown-preview-view>.markdown-preview-sizer{padding-bottom:80vh!important;width:100%!important;max-width:var(--line-width)!important;flex-basis:var(--line-width)!important;transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}.markdown-rendered img:not([width]),.view-content img:not([width]){max-width:100%;outline:0}.document-container>.view-content.embed{display:flex;padding:1em;height:100%;width:100%;align-items:center;justify-content:center}.document-container>.view-content.embed>*{max-width:100%;max-height:100%;object-fit:contain}:has(> :is(.math,table)){overflow-x:auto!important}.document-container>.view-content{overflow-x:auto;contain:content;padding:0;margin:0;height:100%}.scroll-highlight{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1000;background-color:hsla(var(--color-accent-hsl),.25);opacity:0;padding:1em;inset:50%;translate:-50% -50%;border-radius:var(--radius-s)}</style><script defer="">async function loadIncludes(){if("file:"!=location.protocol){let e=document.querySelectorAll("include");for(let t=0;t<e.length;t++){let o=e[t],l=o.getAttribute("src");try{const e=await fetch(l);if(!e.ok){console.log("Could not include file: "+l),o?.remove();continue}let t=await e.text(),n=document.createRange().createContextualFragment(t),i=Array.from(n.children);for(let e of i)e.classList.add("hide"),e.style.transition="opacity 0.5s ease-in-out",setTimeout((()=>{e.classList.remove("hide")}),10);o.before(n),o.remove(),console.log("Included file: "+l)}catch(e){o?.remove(),console.log("Could not include file: "+l,e);continue}}}else{if(document.querySelectorAll("include").length>0){var e=document.createElement("div");e.id="error",e.textContent="Web server exports must be hosted on an http / web server to be viewed correctly.",e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.fontSize="1.5em",e.style.fontWeight="bold",e.style.textAlign="center",document.body.appendChild(e),document.querySelector(".document-container")?.classList.remove("hide")}}}document.addEventListener("DOMContentLoaded",(()=>{loadIncludes()}));let isFileProtocol="file:"==location.protocol;function waitLoadScripts(e,t){let o=e.map((e=>document.getElementById(e+"-script"))),l=0;!function e(){let n=o[l];l++,n&&"true"!=n.getAttribute("loaded")||l<o.length&&e(),l<o.length?n.addEventListener("load",e):t()}()}</script><link rel="stylesheet" href="lib/styles/obsidian.css"><link rel="preload" href="lib/styles/global-variable-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/global-variable-styles.css"></noscript><link rel="preload" href="lib/styles/main-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/main-styles.css"></noscript></head><body class="publish css-settings-manager theme-dark show-inline-title show-ribbon"><script defer="">let theme=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");"dark"==theme?(document.body.classList.add("theme-dark"),document.body.classList.remove("theme-light")):(document.body.classList.add("theme-light"),document.body.classList.remove("theme-dark")),window.innerWidth<480?document.body.classList.add("is-phone"):window.innerWidth<768?document.body.classList.add("is-tablet"):window.innerWidth<1024?document.body.classList.add("is-small-screen"):document.body.classList.add("is-large-screen")</script><div class="webpage-container workspace"><div class="sidebar-left sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><label class="theme-toggle-container" for="theme_toggle"><input class="theme-toggle-input" type="checkbox" id="theme_toggle"><div class="toggle-background"></div></label></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="search-input-container"><input enterkeyhint="search" type="search" spellcheck="false" placeholder="Search..."><div class="search-input-clear-button" aria-label="Clear search"></div></div><include src="lib/html/file-tree.html"></include></div><script defer="">let ls = document.querySelector(".sidebar-left"); ls.classList.add("is-collapsed"); if (window.innerWidth > 768) ls.classList.remove("is-collapsed"); ls.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-left-width"));</script></div><div class="document-container markdown-reading-view hide"><div class="markdown-preview-view markdown-rendered allow-fold-headings allow-fold-lists is-readable-line-width"><style id="MJX-CHTML-styles"></style><pre class="frontmatter language-yaml" tabindex="0" style="display: none;"><code class="language-yaml is-loaded"><span class="token key atrule">tags</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> notes</code><button class="copy-code-button">Copy</button></pre><div class="markdown-preview-sizer markdown-preview-section"><h1 class="page-title heading inline-title" id="AZ-500 Secure Networking"><p dir="auto">AZ-500 Secure Networking</p></h1><div class="el-h1 heading-wrapper"><div class="heading-children"></div></div><div class="el-h1 heading-wrapper"><h1 data-heading="**What is an Azure Virtual Network?**" dir="auto" class="heading" id="**What_is_an_Azure_Virtual_Network?**"><strong>What is an Azure Virtual Network?</strong></h1><div class="heading-children"><div class="el-aside"><aside>
<img draggable="false" class="emoji" alt="✅" src="https://twemoji.maxcdn.com/v/13.1.0/72x72/2705.png"> Azure Virtual Network is a service that provides the fundamental building block for your private network in Azure. An instance of the service (a virtual network) enables many types of Azure resources to securely communicate with each other, the internet, and on-premises networks.</aside></div><div></div><div class="el-h3 heading-wrapper"><h3 data-heading="Reasons to use Azure virtual network:" dir="auto" class="heading" id="Reasons_to_use_Azure_virtual_network:"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Reasons to use Azure virtual network:</h3><div class="heading-children"><div class="el-ul"><ul>
<li data-line="0" dir="auto">Communication of Azure resources with the internet.</li>
<li data-line="1" dir="auto">Communication between Azure resources.</li>
<li data-line="2" dir="auto">Communication with on-premises resources.</li>
<li data-line="3" dir="auto">Filtering of network traffic.</li>
<li data-line="4" dir="auto">Routing of network traffic.</li>
<li data-line="5" dir="auto">Integration with Azure services.</li>
</ul></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="**Communicate with the internet**" dir="auto" class="heading" id="**Communicate_with_the_internet**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Communicate with the internet</strong></h3><div class="heading-children"><div class="el-aside"><aside>
<img draggable="false" class="emoji" alt="✅" src="https://twemoji.maxcdn.com/v/13.1.0/72x72/2705.png"> All resources in a virtual network can communicate outbound with the internet, by default. You can also use a [public IP address](https://learn.microsoft.com/en-us/azure/virtual-network/ip-services/virtual-network-public-ip-address), [NAT gateway](https://learn.microsoft.com/en-us/azure/nat-gateway/nat-overview), or [public load balancer](https://learn.microsoft.com/en-us/azure/load-balancer/load-balancer-overview) to manage your [outbound connections](https://learn.microsoft.com/en-us/azure/load-balancer/load-balancer-outbound-connections). You can communicate inbound with a resource by assigning a public IP address or a public load balancer.</aside></div><div></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="**Communicate between Azure resources**" dir="auto" class="heading" id="**Communicate_between_Azure_resources**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Communicate between Azure resources</strong></h3><div class="heading-children"><div class="el-p"><p dir="auto">Azure resources communicate securely with each other in one of the following ways:</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto"><strong>Virtual network</strong> You can deploy VMs and other types of Azure resources in a virtual network</li>
<li data-line="1" dir="auto"><strong>Virtual network service endpoint</strong> You can extend your virtual network's private address space and the identity of your virtual network to Azure service resources over a direct connection.</li>
<li data-line="2" dir="auto"><strong>Virtual network peering</strong>: You can connect virtual networks to each other by using virtual peering</li>
</ul></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="**Communicate with on-premises resources**" dir="auto" class="heading" id="**Communicate_with_on-premises_resources**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Communicate with on-premises resources</strong></h3><div class="heading-children"><div class="el-ul"><ul>
<li data-line="0" dir="auto"><strong>Point-to-site virtual private network</strong> (VPN): Established between a virtual network and a single computer in your network. Each computer that wants to establish connectivity with a virtual network must configure its connection</li>
<li data-line="1" dir="auto"><strong>Site-to-site VPN</strong>: Established between your on-premises VPN device and an Azure VPN gateway that's deployed in a virtual network</li>
<li data-line="2" dir="auto"><strong>Azure ExpressRoute</strong>: Established between your network and Azure, through an ExpressRoute partner</li>
</ul></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="Network traffic" dir="auto" class="heading" id="Network_traffic"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Network traffic</h2><div class="heading-children"><div class="el-h3 heading-wrapper"><h3 data-heading="Filter network traffic" dir="auto" class="heading" id="Filter_network_traffic"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Filter network traffic</h3><div class="heading-children"><div class="el-p"><p dir="auto">Filter network traffic between subnets:</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Network security groups -</strong> Network security groups and application security groups can contain multiple inbound and outbound security rules
<ul>
<li data-line="1" dir="auto">filter by source and destination IP, address, port and protocol</li>
</ul>
</li>
<li data-line="2" dir="auto"><strong>Network virtual appliances -</strong> A network virtual appliance is a VM that performs a network function, such as a firewall or WAN optimization</li>
</ul></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="Route network traffic" dir="auto" class="heading" id="Route_network_traffic"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Route network traffic</h3><div class="heading-children"><div class="el-aside"><aside>
<img draggable="false" class="emoji" alt="✅" src="https://twemoji.maxcdn.com/v/13.1.0/72x72/2705.png"> Azure routes traffic between subnets, connected virtual networks, on-premises networks, and the internet, by default.</aside></div><div></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">Route tables: You can create <a data-tooltip-position="top" aria-label="https://learn.microsoft.com/en-us/azure/virtual-network/virtual-networks-udr-overview#user-defined" rel="noopener nofollow" class="external-link" href="https://learn.microsoft.com/en-us/azure/virtual-network/virtual-networks-udr-overview#user-defined" target="_blank">custom route tables</a> that control where traffic is routed to for each subnet.</li>
<li data-line="1" dir="auto">Border gateway protocol (BGP) routes: If you connect your virtual network to your on-premises network by using an <a data-tooltip-position="top" aria-label="https://learn.microsoft.com/en-us/azure/vpn-gateway/vpn-gateway-bgp-overview?toc=/azure/virtual-network/toc.json" rel="noopener nofollow" class="external-link" href="https://learn.microsoft.com/en-us/azure/vpn-gateway/vpn-gateway-bgp-overview?toc=/azure/virtual-network/toc.json" target="_blank">Azure VPN gateway</a> or an <a data-tooltip-position="top" aria-label="https://learn.microsoft.com/en-us/azure/expressroute/expressroute-routing?toc=/azure/virtual-network/toc.json#dynamic-route-exchange" rel="noopener nofollow" class="external-link" href="https://learn.microsoft.com/en-us/azure/expressroute/expressroute-routing?toc=/azure/virtual-network/toc.json#dynamic-route-exchange" target="_blank">ExpressRoute</a> connection, you can propagate your on-premises BGP routes to your virtual networks.</li>
</ul></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="**Integrate with Azure services**" dir="auto" class="heading" id="**Integrate_with_Azure_services**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Integrate with Azure services</strong></h3><div class="heading-children"><div class="el-aside"><aside>
<img draggable="false" class="emoji" alt="✅" src="https://twemoji.maxcdn.com/v/13.1.0/72x72/2705.png"> enables private access to the service from virtual machines or compute resources in the virtual network</aside></div><div></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">Deploy <a data-tooltip-position="top" aria-label="https://learn.microsoft.com/en-us/azure/virtual-network/virtual-network-for-azure-services" rel="noopener nofollow" class="external-link" href="https://learn.microsoft.com/en-us/azure/virtual-network/virtual-network-for-azure-services" target="_blank">dedicated instances of the service</a> into a virtual network. The services can then be privately accessed within the virtual network and from on-premises networks.</li>
<li data-line="1" dir="auto">Use <a data-tooltip-position="top" aria-label="https://learn.microsoft.com/en-us/azure/private-link/private-link-overview" rel="noopener nofollow" class="external-link" href="https://learn.microsoft.com/en-us/azure/private-link/private-link-overview" target="_blank">Azure Private Link</a> to privately access a specific instance of the service from your virtual network and from on-premises networks.</li>
<li data-line="2" dir="auto">Access the service over public endpoints by extending a virtual network to the service, through <a data-tooltip-position="top" aria-label="https://learn.microsoft.com/en-us/azure/virtual-network/virtual-network-service-endpoints-overview" rel="noopener nofollow" class="external-link" href="https://learn.microsoft.com/en-us/azure/virtual-network/virtual-network-service-endpoints-overview" target="_blank">service endpoints</a>. Service endpoints allow service resources to be secured to the virtual network.</li>
</ul></div></div></div></div></div></div></div><div class="el-h1 heading-wrapper"><h1 data-heading="**Plan and implement Network Security Groups (NSGs) and Application Security Groups (ASGs)**" dir="auto" class="heading" id="**Plan_and_implement_Network_Security_Groups_(NSGs)_and_Application_Security_Groups_(ASGs)**"><strong>Plan and implement Network Security Groups (NSGs) and Application Security Groups (ASGs)</strong></h1><div class="heading-children"><div class="el-p"><p dir="auto">You can use an Azure network security group to filter network traffic between Azure resources in an Azure virtual network. </p></div><div class="el-aside"><aside>
<img draggable="false" class="emoji" alt="✅" src="https://twemoji.maxcdn.com/v/13.1.0/72x72/2705.png"> A network security group contains security rules that allow or deny inbound network traffic to, or outbound network traffic from, several types of Azure resources</aside></div><div></div><div class="el-h2 heading-wrapper"><h2 data-heading="**Network Security Groups (NSGs)**" dir="auto" class="heading" id="**Network_Security_Groups_(NSGs)**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Network Security Groups (NSGs)</strong></h2><div class="heading-children"><div class="el-h3 heading-wrapper"><h3 data-heading="**Security rules**" dir="auto" class="heading" id="**Security_rules**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Security rules</strong></h3><div class="heading-children"><div class="el-table" dir="ltr" style="overflow-x: auto;"><table>
<thead>
<tr>
<th dir="ltr">Property</th>
<th dir="ltr">Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td dir="ltr">Name</td>
<td dir="ltr">A unique name within the network security group. The name can be up to 80 characters long. It must begin with a word character, and it must end with a word character or with '<em>'. The name may contain word characters or '.', '-', '</em>'.</td>
</tr>
<tr>
<td dir="ltr">Priority</td>
<td dir="ltr">A number between 100 and 4096. Rules are processed in priority order, with lower numbers processed before higher numbers, because lower numbers have higher priority. Once traffic matches a rule, processing stops. As a result, any rules that exist with lower priorities (higher numbers) that have the same attributes as rules with higher priorities aren't processed.Azure default security rules are given the highest  number with the lowest priority to ensure that custom rules are always processed first.</td>
</tr>
<tr>
<td dir="ltr">Source or destination</td>
<td dir="ltr">Any, or an individual IP address, classless inter-domain routing(CIDR) block (10.0.0.0/24, for example), service tag, or application security group. If you specify an address for an Azure resource, specify the private IP address assigned to the resource. Network security groups are processed after Azure translates a public IP address to a private IP address for inbound traffic, and before Azure translates a private IP address to a public IP address for outbound traffic. Fewer <br>security rules are needed when you specify a range, a service tag, or application security group. The ability to specify multiple individual IP addresses and ranges (you can't specify multiple service tags or application groups) in a rule is referred to as augmented security rules. Augmented security rules can only be created in network security groups created through the Resource Manager deployment model. You can't <br>specify multiple IP addresses and IP address ranges in network security groups created through the classic deployment model.</td>
</tr>
<tr>
<td dir="ltr">Protocol</td>
<td dir="ltr">TCP, UDP, ICMP, ESP, AH, or Any. The ESP and AH protocols aren't currently available via the Azure portal but can be used via Azure Resource Manager templates.</td>
</tr>
<tr>
<td dir="ltr">Direction</td>
<td dir="ltr">Whether the rule applies to inbound, or outbound traffic.</td>
</tr>
<tr>
<td dir="ltr">Port range</td>
<td dir="ltr">You can specify an individual or range of ports. For example, you could specify 80 or 10000-10005. Specifying ranges enables you to create fewer security rules. Augmented security rules can only be created in network security groups created through the Resource Manager deployment  model. You can't specify multiple ports or port ranges in the same <br>security rule in network security groups created through the classic deployment model.</td>
</tr>
<tr>
<td dir="ltr">Action</td>
<td dir="ltr">Allow or deny</td>
</tr>
</tbody>
</table></div><div class="el-aside"><aside>
<img draggable="false" class="emoji" alt="✅" src="https://twemoji.maxcdn.com/v/13.1.0/72x72/2705.png"> If you specify an outbound security rule to any address over port 80, for example, it's not necessary to specify an inbound security rule for the response to the outbound traffic. You only need to specify an inbound security rule if communication is initiated externally. The opposite is also true. If inbound traffic is allowed over a port, it's not necessary to specify an outbound security rule to respond to traffic over the port.</aside></div><div></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="**How network security groups filter network traffic**" dir="auto" class="heading" id="**How_network_security_groups_filter_network_traffic**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>How network security groups filter network traffic</strong></h3><div class="heading-children"><div class="el-p"><p dir="auto">The following picture illustrates different scenarios for how network security groups might be deployed to <strong>allow network traffic to and from the internet over TCP port 80</strong></p></div><div class="el-p"><p dir="auto"><span alt="entra-id.png" src="entra-id.png" class="internal-embed media-embed image-embed is-loaded"><img alt="entra-id.png" src="lib/media/entra-id.png"></span></p></div></div></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="**Application Security Groups (ASGs)**" dir="auto" class="heading" id="**Application_Security_Groups_(ASGs)**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Application Security Groups (ASGs)</strong></h2><div class="heading-children"><div class="el-p"><p dir="auto"><span alt="asg.png" src="asg.png" class="internal-embed media-embed image-embed is-loaded"><img alt="asg.png" src="lib/media/asg.png"></span></p></div><div class="el-h3 heading-wrapper"><h3 data-heading="Default rules" dir="auto" class="heading" id="Default_rules"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Default rules</h3><div class="heading-children"><div class="el-p"><p dir="auto"><strong>Allow-HTTP-Inbound-Internet -</strong> This rule is needed to allow traffic from the internet to the web servers. Because inbound traffic from the internet is denied by the DenyAllInbound default security rule, no extra rule is needed for the <em>AsgLogic</em> or <em>AsgDb</em> application security groups.</p></div><div class="el-table" dir="ltr" style="overflow-x: auto;"><table>
<thead>
<tr>
<th dir="ltr">Priority</th>
<th dir="ltr">Source</th>
<th dir="ltr">Source ports</th>
<th dir="ltr">Destination</th>
<th dir="ltr">Destination ports</th>
<th dir="ltr">Protocol</th>
<th dir="ltr">Access</th>
</tr>
</thead>
<tbody>
<tr>
<td dir="auto">100</td>
<td dir="ltr">Internet</td>
<td dir="auto">*</td>
<td dir="ltr">AsgWeb</td>
<td dir="auto">80</td>
<td dir="ltr">TCP</td>
<td dir="ltr">Allow</td>
</tr>
</tbody>
</table></div><div class="el-p"><p dir="auto"><strong>Deny-Database-All -</strong> Because the AllowVNetInBound default security rule allows all communication between resources in the same virtual network, this rule is needed to deny traffic from all resources.</p></div><div class="el-table" dir="ltr" style="overflow-x: auto;"><table>
<thead>
<tr>
<th dir="ltr">Priority</th>
<th dir="ltr">Source</th>
<th dir="ltr">Source ports</th>
<th dir="ltr">Destination</th>
<th dir="ltr">Destination ports</th>
<th dir="ltr">Protocol</th>
<th dir="ltr">Access</th>
</tr>
</thead>
<tbody>
<tr>
<td dir="auto">120</td>
<td dir="auto">*</td>
<td dir="auto">*</td>
<td dir="ltr">AsgDb</td>
<td dir="auto">1433</td>
<td dir="ltr">Any</td>
<td dir="ltr">Deny</td>
</tr>
</tbody>
</table></div><div class="el-p"><p dir="auto"><strong>Allow-Database-BusinessLogic -</strong> This rule allows traffic from the <em>AsgLogic</em> application security group to the <em>AsgDb</em> application security group. The priority for this rule is higher than the priority for the <em>Deny-Database-All</em> rule. As a result, this rule is processed before the <em>Deny-Database-All</em> rule, so traffic from the <em>AsgLogic</em> application security group is allowed, whereas all other traffic is blocked.</p></div><div class="el-table" dir="ltr" style="overflow-x: auto;"><table>
<thead>
<tr>
<th dir="ltr">Priority</th>
<th dir="ltr">Source</th>
<th dir="ltr">Source ports</th>
<th dir="ltr">Destination</th>
<th dir="ltr">Destination ports</th>
<th dir="ltr">Protocol</th>
<th dir="ltr">Access</th>
</tr>
</thead>
<tbody>
<tr>
<td dir="auto">110</td>
<td dir="ltr">AsgLogic</td>
<td dir="auto">*</td>
<td dir="ltr">AsgDb</td>
<td dir="auto">1433</td>
<td dir="ltr">TCP</td>
<td dir="ltr">Allow</td>
</tr>
</tbody>
</table></div></div></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="**Plan and implement User-Defined Routes (UDRs)**" dir="auto" class="heading" id="**Plan_and_implement_User-Defined_Routes_(UDRs)**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Plan and implement User-Defined Routes (UDRs)</strong></h2><div class="heading-children"><div class="el-p"><p dir="auto"><strong>Plan and implement User-Defined Routes (UDRs)</strong></p></div><div class="el-p"><p dir="auto"><strong>You can specify the following next hop types when creating a user-defined route:</strong></p></div><div class="el-p"><p dir="auto">Virtual appliance</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>When you create a route with the virtual appliance hop type, you also specify a next hop IP address. The IP address can be:
<ul>
<li data-line="1" dir="auto">The private IP address of a network interface attached to a virtual machine</li>
<li data-line="2" dir="auto">The private IP address of an Azure internal load balancer.</li>
</ul>
</li>
</ul></div></div></div></div></div><div class="el-h1 heading-wrapper"><h1 data-heading="**Plan and implement Virtual Wide Area Network, including secured virtual hub**" dir="auto" class="heading" id="**Plan_and_implement_Virtual_Wide_Area_Network,_including_secured_virtual_hub**"><strong>Plan and implement Virtual Wide Area Network, including secured virtual hub</strong></h1><div class="heading-children"><div class="el-aside"><aside>
<img draggable="false" class="emoji" alt="✅" src="https://twemoji.maxcdn.com/v/13.1.0/72x72/2705.png"> A Virtual WAN connects to your resources in Azure over an IPsec/IKE (IKEv1 and IKEv2) VPN connection.</aside></div><div></div><div class="el-h3 heading-wrapper"><h3 data-heading="**Prerequisites**" dir="auto" class="heading" id="**Prerequisites**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Prerequisites</strong></h3><div class="heading-children"><div class="el-ul"><ul>
<li data-line="0" dir="auto">Verify that you have an Azure subscription. If you don't already<br>
have an Azure subscription, you can activate your MSDN subscriber<br>
benefits or sign up for a free account.</li>
<li data-line="3" dir="auto">Decide the IP address range that you want to use for your virtual<br>
hub private address space. This information is used when configuring<br>
your virtual hub. A virtual hub is a virtual network that is created and used by Virtual WAN. It's the core of your Virtual WAN network in a<br>
region. The address space range must conform to certain rules.<br>
- The address range that you specify for the hub can't overlap with any of the existing virtual networks that you connect to.<br>
- The address range can't overlap with the on-premises address ranges that you connect to.<br>
- If you're unfamiliar with the IP address ranges located in your<br>
on-premises network configuration, coordinate with someone who can<br>
provide those details for you.</li>
</ul></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="**Azure portal or Azure PowerShell**" dir="auto" class="heading" id="**Azure_portal_or_Azure_PowerShell**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Azure portal or Azure PowerShell</strong></h2><div class="heading-children"><div class="el-p"><p dir="auto">To open Cloud Shell, just select <strong>Open Cloud Shell</strong> from the upper-right corner of a code block. You can also open Cloud Shell on a separate browser tab by going to <a data-tooltip-position="top" aria-label="https://shell.azure.com/powershell" rel="noopener nofollow" class="external-link" href="https://shell.azure.com/powershell" target="_blank"><strong>https://shell.azure.com/powershell</strong></a></p></div><div class="el-h3 heading-wrapper"><h3 data-heading="**Sign in**" dir="auto" class="heading" id="**Sign_in**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Sign in</strong></h3><div class="heading-children"><div class="el-p"><p dir="auto">If you're using <strong>Azure Cloud Shell</strong> you'll automatically be directed to sign into your account after you open Cloud Shell. You don't need to run <code>Connect-AzAccount</code>. Once signed in, you can still change subscriptions if necessary by using <code>Get-AzSubscription</code>and <code>Select-AzSubscription</code>.</p></div><div class="el-aside"><aside>
<img draggable="false" class="emoji" alt="✅" src="https://twemoji.maxcdn.com/v/13.1.0/72x72/2705.png"> If you're running PowerShell locally, open the PowerShell console with elevated privileges and connect to your Azure account.</aside></div><div></div></div></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="**Create a virtual WAN**" dir="auto" class="heading" id="**Create_a_virtual_WAN**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Create a virtual WAN</strong></h2><div class="heading-children"><div class="el-p"><p dir="auto">This example creates a new resource group named TestRG in the East US<br>
location. If you want to use an existing resource group instead, you<br>
can modify the <code>$resourceGroup = Get-AzResourceGroup -ResourceGroupName "NameofResourceGroup"</code>command, and then complete the steps in this exercise using your own values.</p></div><div class="el-ol"><ol>
<li data-line="0" dir="auto">Create a resource group</li>
</ol></div><div class="el-pre"><pre class="language-powershell" tabindex="0"><code data-line="0" class="language-powershell is-loaded"><span class="token function">New-AzResourceGroup</span> <span class="token operator">-</span>Location <span class="token string">"East US"</span> <span class="token operator">-</span>Name <span class="token string">"TestRG"</span>
</code><button class="copy-code-button">Copy</button></pre></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">Create the virtual wan using the New-AzVirtualWan cmdlet.</li>
</ul></div><div class="el-pre"><pre class="language-powershell" tabindex="0"><code data-line="0" class="language-powershell is-loaded"><span class="token variable">$virtualWan</span> = <span class="token function">New-AzVirtualWan</span> <span class="token operator">-</span>ResourceGroupName TestRG <span class="token operator">-</span>Name TestVWAN1 <span class="token operator">-</span>Location <span class="token string">"East US"</span>
</code><button class="copy-code-button">Copy</button></pre></div><div class="el-h3 heading-wrapper"><h3 data-heading="**Create the hub and configure hub settings**" dir="auto" class="heading" id="**Create_the_hub_and_configure_hub_settings**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Create the hub and configure hub settings</strong></h3><div class="heading-children"><div class="el-pre"><pre class="language-powershell" tabindex="0"><code data-line="0" class="language-powershell is-loaded"><span class="token variable">$virtualHub</span> = <span class="token function">New-AzVirtualHub</span> <span class="token operator">-</span>VirtualWan <span class="token variable">$virtualWan</span> <span class="token operator">-</span>ResourceGroupName <span class="token string">"TestRG"</span> <span class="token operator">-</span>Name <span class="token string">"Hub1"</span> <span class="token operator">-</span>AddressPrefix <span class="token string">"10.1.0.0/16"</span> <span class="token operator">-</span>Location <span class="token string">"westus"</span>
</code><button class="copy-code-button">Copy</button></pre></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="**Create a site-to-site VPN gateway**" dir="auto" class="heading" id="**Create_a_site-to-site_VPN_gateway**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Create a site-to-site VPN gateway</strong></h3><div class="heading-children"><div class="el-p"><p dir="auto">If you closed Azure Cloud Shell or your connection timed out, you may need to declare the variable again for $virtualHub.</p></div><div class="el-pre"><pre class="language-powershell" tabindex="0"><code data-line="0" class="language-powershell is-loaded"><span class="token variable">$virtualHub</span> = <span class="token function">Get-AzVirtualHub</span> <span class="token operator">-</span>ResourceGroupName <span class="token string">"TestRG"</span> <span class="token operator">-</span>Name <span class="token string">"Hub1"</span>
</code><button class="copy-code-button">Copy</button></pre></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">Create a VPN gateway using the New-AzVpnGateway cmdlet.</li>
</ul></div><div class="el-pre"><pre class="language-powershell" tabindex="0"><code data-line="0" class="language-powershell is-loaded"><span class="token function">New-AzVpnGateway</span> <span class="token operator">-</span>ResourceGroupName <span class="token string">"TestRG"</span> <span class="token operator">-</span>Name <span class="token string">"vpngw1"</span> <span class="token operator">-</span>VirtualHubId <span class="token variable">$virtualHub</span><span class="token punctuation">.</span>Id <span class="token operator">-</span>VpnGatewayScaleUnit 2
</code><button class="copy-code-button">Copy</button></pre></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">Once your VPN gateway is created, you can view it using the following example.</li>
</ul></div><div class="el-pre"><pre class="language-powershell" tabindex="0"><code data-line="0" class="language-powershell is-loaded"><span class="token function">Get-AzVpnGateway</span> <span class="token operator">-</span>ResourceGroupName <span class="token string">"TestRG"</span> <span class="token operator">-</span>Name <span class="token string">"vpngw1"</span>

</code><button class="copy-code-button">Copy</button></pre></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="**Create a site and connections**" dir="auto" class="heading" id="**Create_a_site_and_connections**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Create a site and connections</strong></h3><div class="heading-children"><div class="el-p"><p dir="auto">Set the variable for the VPN gateway and for the IP address space<br>
that is located on your on-premises site. Traffic destined for this<br>
address space is routed to your local site. This is required when BGP<br>
isn't enabled for the site.</p></div><div class="el-pre"><pre class="language-powershell" tabindex="0"><code data-line="0" class="language-powershell is-loaded"><span class="token variable">$vpnGateway</span> = <span class="token function">Get-AzVpnGateway</span> <span class="token operator">-</span>ResourceGroupName <span class="token string">"TestRG"</span> <span class="token operator">-</span>Name <span class="token string">"vpngw1"</span>
<span class="token variable">$vpnSiteAddressSpaces</span> = <span class="token function">New-Object</span> string<span class="token punctuation">[</span><span class="token punctuation">]</span> 2
<span class="token variable">$vpnSiteAddressSpaces</span><span class="token punctuation">[</span>0<span class="token punctuation">]</span> = <span class="token string">"192.168.2.0/24"</span>
<span class="token variable">$vpnSiteAddressSpaces</span><span class="token punctuation">[</span>1<span class="token punctuation">]</span> = <span class="token string">"192.168.3.0/24"</span>
</code><button class="copy-code-button">Copy</button></pre></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">Create links to add information about the physical links at the<br>
branch including metadata about the link speed, link provider name, and<br>
the public IP address of the on-premises device.</li>
</ul></div><div class="el-pre"><pre class="language-powershell" tabindex="0"><code data-line="0" class="language-powershell is-loaded"><span class="token variable">$vpnSiteLink1</span> = <span class="token function">New-AzVpnSiteLink</span> <span class="token operator">-</span>Name <span class="token string">"TestSite1Link1"</span> <span class="token operator">-</span>IpAddress <span class="token string">"15.25.35.45"</span> <span class="token operator">-</span>LinkProviderName <span class="token string">"SomeTelecomProvider"</span> <span class="token operator">-</span>LinkSpeedInMbps <span class="token string">"10"</span>
<span class="token variable">$vpnSiteLink2</span> = <span class="token function">New-AzVpnSiteLink</span> <span class="token operator">-</span>Name <span class="token string">"TestSite1Link2"</span> <span class="token operator">-</span>IpAddress <span class="token string">"15.25.35.55"</span> <span class="token operator">-</span>LinkProviderName <span class="token string">"SomeTelecomProvider2"</span> <span class="token operator">-</span>LinkSpeedInMbps <span class="token string">"100"</span>
</code><button class="copy-code-button">Copy</button></pre></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">Create the VPN site, referencing the variables of the VPN site<br>
links you just created. If you closed Azure Cloud Shell or your<br>
connection timed out, redeclare the virtual WAN variable:</li>
</ul></div><div class="el-pre"><pre class="language-powershell" tabindex="0"><code data-line="0" class="language-powershell is-loaded"><span class="token variable">$virtualWan</span> = <span class="token function">Get-AzVirtualWAN</span> <span class="token operator">-</span>ResourceGroupName <span class="token string">"TestRG"</span> <span class="token operator">-</span>Name <span class="token string">"TestVWAN1"</span>

</code><button class="copy-code-button">Copy</button></pre></div><div class="el-p"><p dir="auto">Create the VPN site using the New-AzVpnSite cmdlet.</p></div><div class="el-pre"><pre class="language-powershell" tabindex="0"><code data-line="0" class="language-powershell is-loaded"><span class="token variable">$vpnSite</span> = <span class="token function">New-AzVpnSite</span> <span class="token operator">-</span>ResourceGroupName <span class="token string">"TestRG"</span> <span class="token operator">-</span>Name <span class="token string">"TestSite1"</span> <span class="token operator">-</span>Location <span class="token string">"westus"</span> <span class="token operator">-</span>VirtualWan <span class="token variable">$virtualWan</span> <span class="token operator">-</span>AddressSpace <span class="token variable">$vpnSiteAddressSpaces</span> <span class="token operator">-</span>DeviceModel <span class="token string">"SomeDevice"</span> <span class="token operator">-</span>DeviceVendor <span class="token string">"SomeDeviceVendor"</span> <span class="token operator">-</span>VpnSiteLink @<span class="token punctuation">(</span><span class="token variable">$vpnSiteLink1</span><span class="token punctuation">,</span> <span class="token variable">$vpnSiteLink2</span><span class="token punctuation">)</span>
</code><button class="copy-code-button">Copy</button></pre></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">Create the site link connection. The connection is composed of<br>
two active-active tunnels from a branch/site to the scalable gateway.</li>
</ul></div><div class="el-pre"><pre class="language-powershell" tabindex="0"><code data-line="0" class="language-powershell is-loaded"><span class="token variable">$vpnSiteLinkConnection1</span> = <span class="token function">New-AzVpnSiteLinkConnection</span> <span class="token operator">-</span>Name <span class="token string">"TestLinkConnection1"</span> <span class="token operator">-</span>VpnSiteLink <span class="token variable">$vpnSite</span><span class="token punctuation">.</span>VpnSiteLinks<span class="token punctuation">[</span>0<span class="token punctuation">]</span> <span class="token operator">-</span>ConnectionBandwidth 100

<span class="token variable">$vpnSiteLinkConnection2</span> = <span class="token function">New-AzVpnSiteLinkConnection</span> <span class="token operator">-</span>Name <span class="token string">"testLinkConnection2"</span> <span class="token operator">-</span>VpnSiteLink <span class="token variable">$vpnSite</span><span class="token punctuation">.</span>VpnSiteLinks<span class="token punctuation">[</span>1<span class="token punctuation">]</span> <span class="token operator">-</span>ConnectionBandwidth 10

</code><button class="copy-code-button">Copy</button></pre></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="**Connect the VPN site to a hub**" dir="auto" class="heading" id="**Connect_the_VPN_site_to_a_hub**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Connect the VPN site to a hub</strong></h3><div class="heading-children"><div class="el-p"><p dir="auto">Before running the command, you may need to redeclare the following variables:</p></div><div class="el-pre"><pre class="language-powershell" tabindex="0"><code data-line="0" class="language-powershell is-loaded"><span class="token variable">$virtualWan</span> = <span class="token function">Get-AzVirtualWAN</span> <span class="token operator">-</span>ResourceGroupName <span class="token string">"TestRG"</span> <span class="token operator">-</span>Name <span class="token string">"TestVWAN1"</span>
<span class="token variable">$vpnGateway</span> = <span class="token function">Get-AzVpnGateway</span> <span class="token operator">-</span>ResourceGroupName <span class="token string">"TestRG"</span> <span class="token operator">-</span>Name <span class="token string">"vpngw1"</span>
<span class="token variable">$vpnSite</span> = <span class="token function">Get-AzVpnSite</span> <span class="token operator">-</span>ResourceGroupName <span class="token string">"TestRG"</span> <span class="token operator">-</span>Name <span class="token string">"TestSite1"</span>
</code><button class="copy-code-button">Copy</button></pre></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">Connect the VPN site to the hub</li>
</ul></div><div class="el-pre"><pre class="language-powershell" tabindex="0"><code data-line="0" class="language-powershell is-loaded"><span class="token function">New-AzVpnConnection</span> <span class="token operator">-</span>ResourceGroupName <span class="token variable">$vpnGateway</span><span class="token punctuation">.</span>ResourceGroupName <span class="token operator">-</span>ParentResourceName <span class="token variable">$vpnGateway</span><span class="token punctuation">.</span>Name <span class="token operator">-</span>Name <span class="token string">"testConnection"</span> <span class="token operator">-</span>VpnSite <span class="token variable">$vpnSite</span> <span class="token operator">-</span>VpnSiteLinkConnection @<span class="token punctuation">(</span><span class="token variable">$vpnSiteLinkConnection1</span><span class="token punctuation">,</span> <span class="token variable">$vpnSiteLinkConnection2</span><span class="token punctuation">)</span>

</code><button class="copy-code-button">Copy</button></pre></div></div></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="**Connect a VNet to your hub**" dir="auto" class="heading" id="**Connect_a_VNet_to_your_hub**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Connect a VNet to your hub</strong></h2><div class="heading-children"><div class="el-h3 heading-wrapper"><h3 data-heading="**Create a virtual network**" dir="auto" class="heading" id="**Create_a_virtual_network**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Create a virtual network</strong></h3><div class="heading-children"><div class="el-p"><p dir="auto">You can use the following example values to create a VNet. Make sure<br>
to substitute the values in the examples for the values you used for<br>
your environment.</p></div><div class="el-ol"><ol>
<li data-line="0" dir="auto">Create a VNet.</li>
</ol></div><div class="el-pre"><pre class="language-powershell" tabindex="0"><code data-line="0" class="language-powershell is-loaded"><span class="token variable">$vnet</span> = @<span class="token punctuation">{</span> Name = <span class="token string">'VNet1'</span> ResourceGroupName = <span class="token string">'TestRG'</span> Location = <span class="token string">'eastus'</span> AddressPrefix = <span class="token string">'10.21.0.0/16'</span> <span class="token punctuation">}</span> <span class="token variable">$virtualNetwork</span> = <span class="token function">New-AzVirtualNetwork</span> @vnet
</code><button class="copy-code-button">Copy</button></pre></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">Specify subnet settings.</li>
</ul></div><div class="el-pre"><pre class="language-powershell" tabindex="0"><code data-line="0" class="language-powershell is-loaded"><span class="token variable">$subnet</span> = @<span class="token punctuation">{</span> Name = <span class="token string">'Subnet-1'</span> VirtualNetwork = <span class="token variable">$virtualNetwork</span> AddressPrefix = <span class="token string">'10.21.0.0/24'</span> <span class="token punctuation">}</span> <span class="token variable">$subnetConfig</span> = <span class="token function">Add-AzVirtualNetworkSubnetConfig</span> @subnet
</code><button class="copy-code-button">Copy</button></pre></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">Set the VNet.</li>
</ul></div><div class="el-pre"><pre class="language-powershell" tabindex="0"><code data-line="0" class="language-powershell is-loaded"><span class="token variable">$virtualNetwork</span> <span class="token punctuation">|</span> <span class="token function">Set-AzVirtualNetwork</span>

</code><button class="copy-code-button">Copy</button></pre></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="Add a connection" dir="auto" class="heading" id="Add_a_connection"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Add a connection</h3><div class="heading-children"><div class="el-ol"><ol>
<li data-line="0" dir="auto">Declare the variables for the existing resources, including the existing virtual network.</li>
</ol></div><div class="el-pre"><pre class="language-powershell" tabindex="0"><code data-line="0" class="language-powershell is-loaded"><span class="token variable">$resourceGroup</span> = <span class="token function">Get-AzResourceGroup</span> <span class="token operator">-</span>ResourceGroupName <span class="token string">"TestRG"</span> <span class="token variable">$virtualWan</span> = <span class="token function">Get-AzVirtualWan</span> <span class="token operator">-</span>ResourceGroupName <span class="token string">"TestRG"</span> <span class="token operator">-</span>Name <span class="token string">"TestVWAN1"</span> <span class="token variable">$virtualHub</span> = <span class="token function">Get-AzVirtualHub</span> <span class="token operator">-</span>ResourceGroupName <span class="token string">"TestRG"</span> <span class="token operator">-</span>Name <span class="token string">"Hub1"</span> <span class="token variable">$remoteVirtualNetwork</span> = <span class="token function">Get-AzVirtualNetwork</span> <span class="token operator">-</span>Name <span class="token string">"VNet1"</span> <span class="token operator">-</span>ResourceGroupName <span class="token string">"TestRG"</span>
</code><button class="copy-code-button">Copy</button></pre></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">Create a connection to peer the virtual network to the virtual hub.</li>
</ul></div><div class="el-pre"><pre class="language-powershell" tabindex="0"><code data-line="0" class="language-powershell is-loaded"><span class="token function">New-AzVirtualHubVnetConnection</span> <span class="token operator">-</span>ResourceGroupName <span class="token string">"TestRG"</span> <span class="token operator">-</span>VirtualHubName <span class="token string">"Hub1"</span> <span class="token operator">-</span>Name <span class="token string">"VNet1-connection"</span> <span class="token operator">-</span>RemoteVirtualNetwork <span class="token variable">$remoteVirtualNetwork</span>
</code><button class="copy-code-button">Copy</button></pre></div></div></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="**Configure VPN device**" dir="auto" class="heading" id="**Configure_VPN_device**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Configure VPN device</strong></h2><div class="heading-children"><div class="el-h3 heading-wrapper"><h3 data-heading="**Download VPN configuration**" dir="auto" class="heading" id="**Download_VPN_configuration**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Download VPN configuration</strong></h3><div class="heading-children"><div class="el-p"><p dir="auto">Use the VPN device configuration file to configure your on-premises VPN device. Here are the basic steps:</p></div><div class="el-ol"><ol>
<li data-line="0" dir="auto">From your Virtual WAN page, go to <strong>Hubs</strong> -&gt; <strong>Your virtual hub</strong> -&gt; <strong>VPN (Site to site)</strong> page.</li>
<li data-line="1" dir="auto">At the top of the <strong>VPN (Site to site)</strong> page, click <strong>Download VPN Config</strong>. You'll see a series of messages as Azure creates a new storage account in the resource group 'microsoft-network-[location]', where location is the location of the WAN. You can also add an existing storage account by clicking "Use Existing" and adding a valid SAS URL with write permissions enabled.</li>
<li data-line="2" dir="auto">Once the file finishes creating, click the link to download the file. This creates a new file with VPN configuration at the provided SAS url location.</li>
<li data-line="3" dir="auto">Apply the configuration to your on-premises VPN device. For more information, see VPN device configuration in this section.</li>
<li data-line="4" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>After you've applied the configuration to your VPN devices, you aren't required to keep the storage account that you created.
<ul>
<li data-line="5" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Address space of the virtual hub(s) virtual network.
<ul>
<li data-line="6" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Example:
<ul>
<li data-line="7" dir="auto"><code>"AddressSpace":"10.1.0.0/24"</code></li>
</ul>
</li>
</ul>
</li>
<li data-line="8" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Address space of the virtual networks that are connected to the virtual hub.
<ul>
<li data-line="9" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Example:
<ul>
<li data-line="10" dir="auto"><code>"ConnectedSubnets":["10.2.0.0/16","10.3.0.0/16"]</code></li>
</ul>
</li>
</ul>
</li>
<li data-line="11" dir="auto">IP address space of the virtual hub vpngateway. Because each<br>
vpngateway connection is composed of two tunnels in active-active<br>
configuration, you'll see both IP addresses listed in this file. In this example, you see "Instance0" and "Instance1" for each site.<br>
- Example:<br>
- <code>"Instance0":"nnn.nn.nn.nnn"</code><br>
- <code>"Instance1":"nnn.nn.nn.nnn"</code></li>
<li data-line="17" dir="auto">Public IP Address: Assigned by Azure.</li>
<li data-line="18" dir="auto">Private IP Address: Assigned by Azure.</li>
<li data-line="19" dir="auto">Default BGP IP Address: Assigned by Azure.</li>
<li data-line="20" dir="auto">Custom BGP IP Address: This field is reserved for APIPA (Automatic<br>
Private IP Addressing). Azure supports BGP IP in the ranges 169.254.21.<em> and 169.254.22.</em>. Azure accepts BGP connections in these ranges but<br>
will dial connection with the default BGP IP. Users can specify multiple custom BGP IP addresses for each instance. The same custom BGP IP<br>
address shouldn't be used for both instances.</li>
</ul>
</li>
</ol></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="**VPN device configuration file**" dir="auto" class="heading" id="**VPN_device_configuration_file**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>VPN device configuration file</strong></h3><div class="heading-children"><div class="el-p"><p dir="auto">vpnSiteConfiguration - This section denotes the device details set-up as a site connecting to the virtual WAN. It includes the name and public IP address of the branch device.</p></div><div class="el-p"><p dir="auto">vpnSiteConnections - This section provides information about the following settings:</p></div><div class="el-p"><p dir="auto">Vpngateway connection configuration details such as BGP, preshared key etc. The PSK is the preshared key that is automatically generated for you. You can always edit the connection in the Overview page for a custom Pre-Shared Key (PSK).</p></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="**Example device configuration file**" dir="auto" class="heading" id="**Example_device_configuration_file**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Example device configuration file</strong></h3><div class="heading-children"><div class="el-pre"><pre class="language-powershell" tabindex="0"><code data-line="0" class="language-powershell is-loaded"><span class="token punctuation">{</span> <span class="token string">"configurationVersion"</span>:<span class="token punctuation">{</span> <span class="token string">"LastUpdatedTime"</span>:<span class="token string">"2018-07-03T18:29:49.8405161Z"</span><span class="token punctuation">,</span> <span class="token string">"Version"</span>:<span class="token string">"r403583d-9c82-4cb8-8570-1cbbcd9983b5"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">"vpnSiteConfiguration"</span>:<span class="token punctuation">{</span> <span class="token string">"Name"</span>:<span class="token string">"testsite1"</span><span class="token punctuation">,</span> <span class="token string">"IPAddress"</span>:<span class="token string">"73.239.3.208"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">"vpnSiteConnections"</span>:<span class="token punctuation">[</span> <span class="token punctuation">{</span> <span class="token string">"hubConfiguration"</span>:<span class="token punctuation">{</span> <span class="token string">"AddressSpace"</span>:<span class="token string">"10.1.0.0/24"</span><span class="token punctuation">,</span> <span class="token string">"Region"</span>:<span class="token string">"West Europe"</span><span class="token punctuation">,</span> <span class="token string">"ConnectedSubnets"</span>:<span class="token punctuation">[</span> <span class="token string">"10.2.0.0/16"</span><span class="token punctuation">,</span> <span class="token string">"10.3.0.0/16"</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">"gatewayConfiguration"</span>:<span class="token punctuation">{</span> <span class="token string">"IpAddresses"</span>:<span class="token punctuation">{</span> <span class="token string">"Instance0"</span>:<span class="token string">"104.45.18.186"</span><span class="token punctuation">,</span> <span class="token string">"Instance1"</span>:<span class="token string">"104.45.13.195"</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">"connectionConfiguration"</span>:<span class="token punctuation">{</span> <span class="token string">"IsBgpEnabled"</span>:false<span class="token punctuation">,</span> <span class="token string">"PSK"</span>:<span class="token string">"bkOWe5dPPqkx0DfFE3tyuP7y3oYqAEbI"</span><span class="token punctuation">,</span> <span class="token string">"IPsecParameters"</span>:<span class="token punctuation">{</span> <span class="token string">"SADataSizeInKilobytes"</span>:102400000<span class="token punctuation">,</span> <span class="token string">"SALifeTimeInSeconds"</span>:3600 <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token string">"configurationVersion"</span>:<span class="token punctuation">{</span> <span class="token string">"LastUpdatedTime"</span>:<span class="token string">"2018-07-03T18:29:49.8405161Z"</span><span class="token punctuation">,</span> <span class="token string">"Version"</span>:<span class="token string">"1f33f891-e1ab-42b8-8d8c-c024d337bcac"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">"vpnSiteConfiguration"</span>:<span class="token punctuation">{</span> <span class="token string">"Name"</span>:<span class="token string">" testsite2"</span><span class="token punctuation">,</span> <span class="token string">"IPAddress"</span>:<span class="token string">"66.193.205.122"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">"vpnSiteConnections"</span>:<span class="token punctuation">[</span> <span class="token punctuation">{</span> <span class="token string">"hubConfiguration"</span>:<span class="token punctuation">{</span> <span class="token string">"AddressSpace"</span>:<span class="token string">"10.1.0.0/24"</span><span class="token punctuation">,</span> <span class="token string">"Region"</span>:<span class="token string">"West Europe"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">"gatewayConfiguration"</span>:<span class="token punctuation">{</span> <span class="token string">"IpAddresses"</span>:<span class="token punctuation">{</span> <span class="token string">"Instance0"</span>:<span class="token string">"104.45.18.187"</span><span class="token punctuation">,</span> <span class="token string">"Instance1"</span>:<span class="token string">"104.45.13.195"</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">"connectionConfiguration"</span>:<span class="token punctuation">{</span> <span class="token string">"IsBgpEnabled"</span>:false<span class="token punctuation">,</span> <span class="token string">"PSK"</span>:<span class="token string">"XzODPyAYQqFs4ai9WzrJour0qLzeg7Qg"</span><span class="token punctuation">,</span> <span class="token string">"IPsecParameters"</span>:<span class="token punctuation">{</span> <span class="token string">"SADataSizeInKilobytes"</span>:102400000<span class="token punctuation">,</span> <span class="token string">"SALifeTimeInSeconds"</span>:3600 <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token string">"configurationVersion"</span>:<span class="token punctuation">{</span> <span class="token string">"LastUpdatedTime"</span>:<span class="token string">"2018-07-03T18:29:49.8405161Z"</span><span class="token punctuation">,</span> <span class="token string">"Version"</span>:<span class="token string">"cd1e4a23-96bd-43a9-93b5-b51c2a945c7"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">"vpnSiteConfiguration"</span>:<span class="token punctuation">{</span> <span class="token string">"Name"</span>:<span class="token string">" testsite3"</span><span class="token punctuation">,</span> <span class="token string">"IPAddress"</span>:<span class="token string">"182.71.123.228"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">"vpnSiteConnections"</span>:<span class="token punctuation">[</span> <span class="token punctuation">{</span> <span class="token string">"hubConfiguration"</span>:<span class="token punctuation">{</span> <span class="token string">"AddressSpace"</span>:<span class="token string">"10.1.0.0/24"</span><span class="token punctuation">,</span> <span class="token string">"Region"</span>:<span class="token string">"West Europe"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">"gatewayConfiguration"</span>:<span class="token punctuation">{</span> <span class="token string">"IpAddresses"</span>:<span class="token punctuation">{</span> <span class="token string">"Instance0"</span>:<span class="token string">"104.45.18.187"</span><span class="token punctuation">,</span> <span class="token string">"Instance1"</span>:<span class="token string">"104.45.13.195"</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">"connectionConfiguration"</span>:<span class="token punctuation">{</span> <span class="token string">"IsBgpEnabled"</span>:false<span class="token punctuation">,</span> <span class="token string">"PSK"</span>:<span class="token string">"YLkSdSYd4wjjEThR3aIxaXaqNdxUwSo9"</span><span class="token punctuation">,</span> <span class="token string">"IPsecParameters"</span>:<span class="token punctuation">{</span> <span class="token string">"SADataSizeInKilobytes"</span>:102400000<span class="token punctuation">,</span> <span class="token string">"SALifeTimeInSeconds"</span>:3600 <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
</code><button class="copy-code-button">Copy</button></pre></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="View or edit gateway settings" dir="auto" class="heading" id="View_or_edit_gateway_settings"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>View or edit gateway settings</h3><div class="heading-children"><div class="el-p"><p dir="auto">You can view and edit your VPN gateway settings at any time. Go to your <strong>Virtual HUB</strong> -&gt; <strong>VPN (Site to site)</strong> and select <strong>View/Configure</strong>.</p></div><div class="el-p"><p dir="auto"><img alt="https://learn.microsoft.com/en-us/training/wwl-azure/security-virtual-networks/media/view-configuration-1-f41fd8a5.png" src="https://learn.microsoft.com/en-us/training/wwl-azure/security-virtual-networks/media/view-configuration-1-f41fd8a5.png" referrerpolicy="no-referrer"></p></div><div class="el-p"><p dir="auto">On the <strong>Edit VPN Gateway</strong> page, you can see the following settings:</p></div><div class="el-p"><p dir="auto"><img alt="https://learn.microsoft.com/en-us/training/wwl-azure/security-virtual-networks/media/edit-virtual-private-network-gateway-example-8cb0ec23.png" src="https://learn.microsoft.com/en-us/training/wwl-azure/security-virtual-networks/media/edit-virtual-private-network-gateway-example-8cb0ec23.png" referrerpolicy="no-referrer"></p></div></div></div></div></div></div></div><div class="el-h1 heading-wrapper"><h1 data-heading="Secure VPN connectivity" dir="auto" class="heading" id="Secure_VPN_connectivity">Secure VPN connectivity</h1><div class="heading-children"><div class="el-aside"><aside>
<img draggable="false" class="emoji" alt="✅" src="https://twemoji.maxcdn.com/v/13.1.0/72x72/2705.png"> There are various types of VPN configurations. Diagrams below show the main baseline topologies</aside></div><div></div><div class="el-h2 heading-wrapper"><h2 data-heading="Site-to-Site VPN" dir="auto" class="heading" id="Site-to-Site_VPN"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Site-to-Site VPN</h2><div class="heading-children"><div class="el-h3 heading-wrapper"><h3 data-heading="Connection is over IPsec/IKE(IKEv1 or IKEv2) VPN tunnel" dir="auto" class="heading" id="Connection_is_over_IPsec/IKE(IKEv1_or_IKEv2)_VPN_tunnel"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Connection is over IPsec/IKE(IKEv1 or IKEv2) VPN tunnel</h3><div class="heading-children"><div class="el-aside"><aside>
<img draggable="false" class="emoji" alt="✅" src="https://twemoji.maxcdn.com/v/13.1.0/72x72/2705.png"> S2S connection requires VPN device located on-premises that has a public IP address</aside></div><div></div><div class="el-p"><p dir="auto"><span alt="azure1.png" src="azure1.png" class="internal-embed media-embed image-embed is-loaded"><img alt="azure1.png" src="lib/media/azure1.png"></span></p></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="For creating a connection to multiple on-premises sites" dir="auto" class="heading" id="For_creating_a_connection_to_multiple_on-premises_sites"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>For creating a connection to multiple on-premises sites</h3><div class="heading-children"><div class="el-ul"><ul>
<li data-line="0" dir="auto">must use RouteBased VPN (known as dynamic gateway)</li>
</ul></div><div class="el-p"><p dir="auto"><span alt="azure2 1.png" src="azure2 1.png" class="internal-embed media-embed image-embed is-loaded"><img alt="azure2 1.png" src="lib/media/azure2-1.png"></span></p></div></div></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="**Point-to-site Virtual Private Network**" dir="auto" class="heading" id="**Point-to-site_Virtual_Private_Network**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Point-to-site Virtual Private Network</strong></h2><div class="heading-children"><div class="el-h3 heading-wrapper"><h3 data-heading="Secure connection to virtual network from an individual client computer" dir="auto" class="heading" id="Secure_connection_to_virtual_network_from_an_individual_client_computer"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Secure connection to virtual network from an individual client computer</h3><div class="heading-children"><div class="el-aside"><aside>
<img draggable="false" class="emoji" alt="✅" src="https://twemoji.maxcdn.com/v/13.1.0/72x72/2705.png"> Gives the ability to connect to Azure VNets from a remote location</aside></div><div></div><div class="el-p"><p dir="auto">Does not require on-premises public-facing IP address or a VPN device</p></div><div class="el-p"><p dir="auto"><span alt="azure3.png" src="azure3.png" class="internal-embed media-embed image-embed is-loaded"><img alt="azure3.png" src="lib/media/azure3.png"></span></p></div></div></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="**VNet-to-VNet connections (Internet Protocol Secure/Internet Key Exchange Virtual Private Network Tunnel)**" dir="auto" class="heading" id="**VNet-to-VNet_connections_(Internet_Protocol_Secure/Internet_Key_Exchange_Virtual_Private_Network_Tunnel)**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>VNet-to-VNet connections (Internet Protocol Secure/Internet Key Exchange Virtual Private Network Tunnel)</strong></h2><div class="heading-children"><div class="el-p"><p dir="auto">Similar to connecting a VNet to an on-premises site location</p></div><div class="el-p"><p dir="auto"><span alt="azure4.png" src="azure4.png" class="internal-embed media-embed image-embed is-loaded"><img alt="azure4.png" src="lib/media/azure4.png"></span></p></div><div class="el-h3 heading-wrapper"><h3 data-heading="**Connections between deployment models**" dir="auto" class="heading" id="**Connections_between_deployment_models**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Connections between deployment models</strong></h3><div class="heading-children"><div class="el-p"><p dir="auto">Two deployment models:</p></div><div class="el-ol"><ol>
<li data-line="0" dir="auto">classic</li>
<li data-line="1" dir="auto">Resource Manager</li>
</ol></div></div></div></div></div></div></div><div class="el-h1 heading-wrapper"><h1 data-heading="Azure ExpressRoute" dir="auto" class="heading" id="Azure_ExpressRoute">Azure ExpressRoute</h1><div class="heading-children"><div class="el-aside"><aside>
<img draggable="false" class="emoji" alt="✅" src="https://twemoji.maxcdn.com/v/13.1.0/72x72/2705.png"> ExpressRoute lets you extend your on-premises networks into the Microsoft cloud over a private connection with the help of a connectivity provider</aside></div><div></div><div class="el-p"><p dir="auto">ExpressRoute connections offer more reliability, faster speeds, consistent latencies, and higher security than typical connections over the Internet, because they don’t go over the public Internet.</p></div><div class="el-p"><p dir="auto"><span alt="azure5.png" src="azure5.png" class="internal-embed media-embed image-embed is-loaded"><img alt="azure5.png" src="lib/media/azure5.png"></span></p></div><div class="el-h3 heading-wrapper"><h3 data-heading="Key Benefits" dir="auto" class="heading" id="Key_Benefits"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Key Benefits</h3><div class="heading-children"><div class="el-ul"><ul>
<li data-line="0" dir="auto">Layer 3 connectivity between your on-premises network and the<br>
Microsoft Cloud through a connectivity provider. Connectivity can be<br>
from an any-to-any (IPVPN) network, a point-to-point Ethernet<br>
connection, or through a virtual cross-connection via an Ethernet<br>
exchange.</li>
<li data-line="5" dir="auto">Connectivity to Microsoft cloud services across all regions in the geopolitical region.</li>
<li data-line="6" dir="auto">Global connectivity to Microsoft services across all regions with the ExpressRoute premium add-on.</li>
<li data-line="7" dir="auto">Dynamic routing between your network and Microsoft via border gateway protocol (BGP).</li>
<li data-line="8" dir="auto">Built-in redundancy in every peering location for higher reliability.</li>
<li data-line="9" dir="auto">Connection uptime service level agreement (SLA).</li>
<li data-line="10" dir="auto">Quality of Service (QoS) support for Skype for Business.</li>
</ul></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="Features" dir="auto" class="heading" id="Features"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Features</h3><div class="heading-children"><div class="el-p"><p dir="auto"><strong>Layer 3 Connectivity</strong></p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">uses BGP to exchange between on-premises network, instances in Azure, and Microsoft public addresses</li>
</ul></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="Redundancy" dir="auto" class="heading" id="Redundancy"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Redundancy</h3><div class="heading-children"><div class="el-p"><p dir="auto"><em>Consists of two connections to two Microsoft Enterprise edge router (MSEEs)</em></p></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="Flexible billing models" dir="auto" class="heading" id="Flexible_billing_models"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Flexible billing models</h2><div class="heading-children"><div class="el-ul"><ul>
<li data-line="0" dir="auto">You can select a billing model that works best for you:</li>
<li data-line="1" dir="auto">Unlimited data. Billing is based on a monthly fee; all inbound and outbound data transfer is included free of charge.</li>
<li data-line="2" dir="auto">Metered data. Billing is based on a monthly fee; all inbound data<br>
transfer is free of charge. Outbound data transfer is charged per GB of<br>
data transfer. Data transfer rates vary by region.</li>
<li data-line="5" dir="auto">ExpressRoute premium add-on. ExpressRoute premium is an add-on to<br>
the ExpressRoute circuit. The ExpressRoute premium add-on provides the<br>
following capabilities:<br>
- Increased route limits for Azure public and Azure private peering from 4,000 routes to 10,000 routes.<br>
- Global connectivity for services. An ExpressRoute circuit created in any region (excluding national clouds) has access to resources across<br>
every other region in the world. For example, a virtual network created<br>
in West Europe can be accessed through an ExpressRoute circuit<br>
provisioned in Silicon Valley.<br>
- Increased number of virtual network links per ExpressRoute circuit<br>
from 10 to a larger limit, depending on the bandwidth of the circuit.</li>
</ul></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="**Implement encryption over ExpressRoute**" dir="auto" class="heading" id="**Implement_encryption_over_ExpressRoute**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Implement encryption over ExpressRoute</strong></h2><div class="heading-children"><div class="el-p"><p dir="auto">Deploy Azure Virtual WAN to establish an IPsec/IKE VPN connection from your on-premises network to Azure over the private peering of an Azure ExpressRoute circuit.</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">provides an encrypted transit between the on-premises network and Azure virtual networks over ExpressRoute, without using public internet</li>
</ul></div><div class="el-p"><p dir="auto"><strong>Topology and Routing</strong></p></div><div class="el-p"><p dir="auto"><span alt="azure6.png" src="azure6.png" class="internal-embed media-embed image-embed is-loaded"><img alt="azure6.png" src="lib/media/azure6.png"></span></p></div><div class="el-h3 heading-wrapper"><h3 data-heading="**Traffic from on-premises networks to Azure**" dir="auto" class="heading" id="**Traffic_from_on-premises_networks_to_Azure**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Traffic from on-premises networks to Azure</strong></h3><div class="heading-children"><div class="el-p"><p dir="auto">Advertised via both the ExpressRoute private peering BGP and the VPN BGP</p></div><div class="el-p"><p dir="auto">Two network routes:</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">One over the IPsec-protected path</li>
<li data-line="1" dir="auto">One directly over ExpressRoute without IPsec protection</li>
</ul></div><div class="el-aside"><aside>
<img draggable="false" class="emoji" alt="✅" src="https://twemoji.maxcdn.com/v/13.1.0/72x72/2705.png"> To apply encryption to the communication, you must make sure that for the VPN-connected network in the diagram, the Azure routes via on-premises VPN gateway are preferred over the direct ExpressRoute path.</aside></div><div></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="**Traffic from Azure to on-premises networks**" dir="auto" class="heading" id="**Traffic_from_Azure_to_on-premises_networks**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Traffic from Azure to on-premises networks</strong></h3><div class="heading-children"><div class="el-p"><p dir="auto">To ensure that the IPsec path is preferred over the direct ExpressRoute path (without IPsec), you have two options:</p></div><div class="el-ol"><ol>
<li data-line="0" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Advertise more specific prefixes on the VPN BGP session for the VPN-connected network
<ul>
<li data-line="1" dir="auto">For example, advertise 10.0.0.0/16 over ExpressRoute, and 10.0.1.0/24 over VPN.</li>
</ul>
</li>
<li data-line="2" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Advertise disjoint prefixes for VPN and ExpressRoute
<ul>
<li data-line="3" dir="auto">For example, advertise 10.0.0.0/24 over ExpressRoute, and 10.0.1.0/24 over VPN.</li>
</ul>
</li>
</ol></div></div></div></div></div></div></div><div class="el-h1 heading-wrapper"><h1 data-heading="Lab: Configuring VPN ExpressRoute Connection" dir="auto" class="heading" id="Lab:_Configuring_VPN_ExpressRoute_Connection">Lab: Configuring VPN ExpressRoute Connection</h1><div class="heading-children"><div class="el-h2 heading-wrapper"><h2 data-heading="Before you begin" dir="auto" class="heading" id="Before_you_begin"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Before you begin</h2><div class="heading-children"><div class="el-p"><p dir="auto">Before you start your configuration, verify that you meet the following criteria:</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">If you already have virtual network that you want to connect to,<br>
verify that none of the subnets of your on-premises network overlap with it. Your virtual network doesn't require a gateway subnet and can't<br>
have any virtual network gateways. If you don't have a virtual network,<br>
you can create one by using the steps in this article.</li>
<li data-line="4" dir="auto">Obtain an IP address range for your hub region. The hub is a virtual network, and the address range that you specify for the hub region<br>
can't overlap with an existing virtual network that you connect to. It<br>
also can't overlap with the address ranges that you connect to<br>
on-premises. If you're unfamiliar with the IP address ranges located in<br>
your on-premises network configuration, coordinate with someone who can<br>
provide those details for you.</li>
<li data-line="10" dir="auto">If you don't have an Azure subscription, create a free account before you begin.</li>
</ul></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="1. Create a virtual WAN and hub with gateways" dir="auto" class="heading" id="1._Create_a_virtual_WAN_and_hub_with_gateways"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>1. Create a virtual WAN and hub with gateways</h2><div class="heading-children"><div class="el-p"><p dir="auto">The following Azure resources and the corresponding on-premises configurations must be in place before you proceed:</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">An Azure virtual WAN.</li>
<li data-line="1" dir="auto">A virtual WAN hub with an ExpressRoute and a Virtual Private Network gateway.</li>
</ul></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="2. Create a site for the on-premises network" dir="auto" class="heading" id="2._Create_a_site_for_the_on-premises_network"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>2. Create a site for the on-premises network</h2><div class="heading-children"><div class="el-p"><p dir="auto">The site resource is the same as the non-ExpressRoute VPN sites for a<br>
virtual WAN. The IP address of the on-premises VPN device can now be<br>
either a private IP address, or a public IP address in the on-premises<br>
network reachable via the previously created ExpressRoute private<br>
peering configuration.</p></div><div class="el-ol"><ol>
<li data-line="0" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Go to <strong>Your Virtual WAN</strong>, <strong>VPN</strong> sites and create a site for your on-premises network. Keep in mind the following settings values:
<ul>
<li data-line="1" dir="auto">Border Gateway Protocol: Select "Enable" if your on-premises network uses BGP.</li>
<li data-line="2" dir="auto">Private address space: Enter the IP address space that's located on<br>
your on-premises site. Traffic destined for this address space is routed to the on-premises network via the VPN gateway.</li>
</ul>
</li>
<li data-line="4" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Select Links to add information about the physical links. Keep in mind the following settings information:
<ul>
<li data-line="5" dir="auto">Provider Name: The name of the internet service provider for this<br>
site. For an ExpressRoute on-premises network, it's the name of the<br>
ExpressRoute service provider.</li>
<li data-line="8" dir="auto">Speed: The speed of the internet service link or ExpressRoute circuit.</li>
<li data-line="9" dir="auto">IP address: The public IP address of the VPN device that resides on<br>
your on-premises site. Or, for ExpressRoute on-premises, it's the<br>
private IP address of the VPN device via ExpressRoute.</li>
<li data-line="12" dir="auto">If BGP is enabled, it applies to all connections created for this<br>
site in Azure. Configuring BGP on a virtual WAN is equivalent to<br>
configuring BGP on an Azure VPN gateway.</li>
<li data-line="15" dir="auto">Your on-premises BGP peer address <em>must not</em> be the same as<br>
the IP address of your VPN to the device or the virtual network address<br>
space of the VPN site. Use a different IP address on the VPN device for<br>
your BGP peer IP. It can be an address assigned to the loopback<br>
interface on the device. However, it <em>can't</em> be an APIPA (169.254.<em>x</em>.<em>x</em>) address. Specify this address in the corresponding VPN site that represents the location.</li>
</ul>
</li>
<li data-line="20" dir="auto">Select <strong>Next: Review + create</strong> to check the setting values and create the VPN site, then <strong>Create</strong> the site.</li>
<li data-line="21" dir="auto">Next, connect the site to the hub. It can take up to 30 minutes to update the gateway.</li>
</ol></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="3. Update the VPN connection setting to use ExpressRoute" dir="auto" class="heading" id="3._Update_the_VPN_connection_setting_to_use_ExpressRoute"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>3. Update the VPN connection setting to use ExpressRoute</h2><div class="heading-children"><div class="el-p"><p dir="auto">After you create the VPN site and connect to the hub, use the<br>
following steps to configure the connection to use ExpressRoute private<br>
peering:</p></div><div class="el-ol"><ol>
<li data-line="0" dir="auto">Go to the virtual hub. You can either do this by going to the<br>
Virtual WAN and selecting the hub to open the hub page, or you can go to the connected virtual hub from the VPN site.</li>
<li data-line="2" dir="auto">Under <strong>Connectivity</strong>, select <strong>VPN (Site-to-Site)</strong>.</li>
<li data-line="3" dir="auto">Select the ellipsis (<strong>...</strong>) or right click the VPN site over ExpressRoute, and select <strong>Edit VPN connection to this hub</strong>.</li>
<li data-line="4" dir="auto">On the <strong>Basics</strong> page, leave the defaults.</li>
<li data-line="5" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>On the <strong>Link connection 1</strong> page, configure the following settings:
<ul>
<li data-line="6" dir="auto">For <strong>Use Azure Private IP Address</strong>, select <strong>Yes</strong>. The setting configures the hub VPN gateway to use private IP addresses<br>
within the hub address range on the gateway for this connection, instead of the public IP addresses. This ensures that the traffic from the<br>
on-premises network traverses the ExpressRoute private peering paths<br>
rather than using the public internet for this VPN connection.</li>
</ul>
</li>
<li data-line="10" dir="auto">Click <strong>Create</strong> to update the settings. After the<br>
settings have been created, the hub VPN gateway will use the private IP<br>
addresses on the VPN gateway to establish the IPsec/IKE connections with the on-premises VPN device over ExpressRoute.</li>
</ol></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="4. Get the private IP addresses for the hub VPN gateway" dir="auto" class="heading" id="4._Get_the_private_IP_addresses_for_the_hub_VPN_gateway"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>4. Get the private IP addresses for the hub VPN gateway</h2><div class="heading-children"><div class="el-p"><p dir="auto">Download the VPN device configuration to get the private IP addresses<br>
of the hub VPN gateway. You need these addresses to configure the<br>
on-premises VPN device.</p></div><div class="el-ol"><ol>
<li data-line="0" dir="auto">On the page for your hub, select <strong>VPN (Site-to-Site)</strong> under <strong>Connectivity</strong>.</li>
<li data-line="1" dir="auto">At the top of the <strong>Overview</strong> page, select <strong>Download VPN Config</strong>. Azure creates a storage account in the resource group "microsoft-network-[location]," where <em>location</em> is the location of the WAN. After you apply the configuration to your VPN devices, you can delete this storage account.</li>
<li data-line="2" dir="auto">After the file is created, select the link to download it.</li>
<li data-line="3" dir="auto">Apply the configuration to your VPN device.</li>
</ol></div><div class="el-h3 heading-wrapper"><h3 data-heading="VPN device configuration file" dir="auto" class="heading" id="VPN_device_configuration_file"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>VPN device configuration file</h3><div class="heading-children"><div class="el-p"><p dir="auto">The device configuration file contains the settings to use when<br>
you're configuring your on-premises VPN device. When you view this file,<br>
notice the following information:</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">vpnSiteConfiguration: This section denotes the device details<br>
setup as a site that's connecting to the virtual WAN. It includes the<br>
name and public IP address of the branch device.</li>
<li data-line="3" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>vpnSiteConnections: This section provides information about the following settings:
<ul>
<li data-line="4" dir="auto">Address space of the virtual hub's virtual network.Example: <code>"AddressSpace":"10.51.230.0/24"</code></li>
<li data-line="5" dir="auto">Address space of the virtual networks that are connected to the hub.Example: <code>"ConnectedSubnets":["10.51.231.0/24"]</code></li>
<li data-line="6" dir="auto">IP addresses of the virtual hub's VPN gateway. Because each<br>
connection of the VPN gateway is composed of two tunnels in<br>
active-active configuration, you'll see both IP addresses listed in this file. In this example, you see Instance0 and Instance1 for each site,<br>
and they're private IP addresses instead of public IP addresses.Example: <code>"Instance0":"10.51.230.4" "Instance1":"10.51.230.5"</code></li>
<li data-line="10" dir="auto">Configuration details for the VPN gateway connection, such as BGP<br>
and preshared key. The preshared key is automatically generated for you. You can always edit the connection on the <strong>Overview</strong> page for a custom preshared key.</li>
</ul>
</li>
</ul></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="Configuring your VPN device" dir="auto" class="heading" id="Configuring_your_VPN_device"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Configuring your VPN device</h3><div class="heading-children"><div class="el-p"><p dir="auto">If you need instructions to configure your device, you can use the<br>
instructions on the VPN device configuration scripts page with the<br>
following caveats:</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">The instructions on the VPN device page aren't written for a virtual WAN. But you can use the virtual WAN values from the configuration file to manually configure your VPN device.</li>
<li data-line="1" dir="auto">The downloadable device configuration scripts that are for the VPN<br>
gateway don't work for the virtual WAN, because the configuration is<br>
different.</li>
<li data-line="4" dir="auto">A new virtual WAN can support both IKEv1 and IKEv2.</li>
<li data-line="5" dir="auto">A virtual WAN can use only route-based VPN devices and device instructions.</li>
</ul></div></div></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="5. View your virtual WAN" dir="auto" class="heading" id="5._View_your_virtual_WAN"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>5. View your virtual WAN</h2><div class="heading-children"><div class="el-ol"><ol>
<li data-line="0" dir="auto">Go to the virtual WAN.</li>
<li data-line="1" dir="auto">On the <strong>Overview</strong> page, each point on the map represents a hub.</li>
<li data-line="2" dir="auto">In the <strong>Hubs and connections</strong> section, you can view hub, site, region, and VPN connection status. You can also view bytes in and out.</li>
</ol></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="6. Monitor a connection" dir="auto" class="heading" id="6._Monitor_a_connection"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>6. Monitor a connection</h2><div class="heading-children"><div class="el-p"><p dir="auto">Create a connection to monitor communication between an Azure virtual machine (VM) and a remote site.</p></div></div></div></div></div><div class="el-h1 heading-wrapper"><h1 data-heading="Configure firewall settings on PaaS resources" dir="auto" class="heading" id="Configure_firewall_settings_on_PaaS_resources">Configure firewall settings on PaaS resources</h1><div class="heading-children"><div class="el-h2 heading-wrapper"><h2 data-heading="**Cloud security advantages**" dir="auto" class="heading" id="**Cloud_security_advantages**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Cloud security advantages</strong></h2><div class="heading-children"><div class="el-p"><p dir="auto">Organizations are able to improve their threat detection and response times by using a provider's cloud-based security capabilities and cloud intelligence. By shifting responsibilities to the cloud provider, organizations can get more security coverage, which enables them to reallocate security resources and budget to other business priorities.</p></div><div class="el-h3 heading-wrapper"><h3 data-heading="**Security advantages of a PaaS cloud service model**" dir="auto" class="heading" id="**Security_advantages_of_a_PaaS_cloud_service_model**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Security advantages of a PaaS cloud service model</strong></h3><div class="heading-children"><div class="el-p"><p dir="auto"><span alt="azure7.png" src="azure7.png" class="internal-embed media-embed image-embed is-loaded"><img alt="azure7.png" src="lib/media/azure7.png"></span></p></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="**Adopt a policy of identity as the primary security perimeter**" dir="auto" class="heading" id="**Adopt_a_policy_of_identity_as_the_primary_security_perimeter**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Adopt a policy of identity as the primary security perimeter</strong></h3><div class="heading-children"><div class="el-p"><p dir="auto">The following figure shows how the security perimeter has evolved from a network perimeter to an identity perimeter. Security becomes less about defending your network and more about defending your data, as well as managing the security of your apps and users</p></div><div class="el-p"><p dir="auto"><span alt="azure8.png" src="azure8.png" class="internal-embed media-embed image-embed is-loaded"><img alt="azure8.png" src="lib/media/azure8.png"></span></p></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="**Use threat modeling during application design**" dir="auto" class="heading" id="**Use_threat_modeling_during_application_design**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Use threat modeling during application design</strong></h3><div class="heading-children"><div class="el-p"><p dir="auto">To help facilitate this process, Microsoft has created the SDL Threat Modeling Tool. Modeling the application design and enumerating STRIDE (Spoofing, Tampering, Repudiation, Information Disclosure, Denial of Service DoS, and Elevation) of privilege threats across all trust boundaries can catch design errors early on.</p></div><div class="el-table" dir="ltr" style="overflow-x: auto;"><table>
<thead>
<tr>
<th dir="ltr">Threat</th>
<th dir="ltr">Security property</th>
<th dir="ltr">Potential Azure platform mitigations</th>
</tr>
</thead>
<tbody>
<tr>
<td dir="ltr">Spoofing</td>
<td dir="ltr">Authentication</td>
<td dir="ltr">Require HTTPS connections.</td>
</tr>
<tr>
<td dir="ltr">Tampering</td>
<td dir="ltr">Integrity</td>
<td dir="ltr">Validate TLS/SSL certificates.</td>
</tr>
<tr>
<td dir="ltr">Repudiation</td>
<td dir="ltr">Non-repudiation</td>
<td dir="ltr">Enable Azure monitoring and diagnostics.</td>
</tr>
<tr>
<td dir="ltr">Information disclosure</td>
<td dir="ltr">Confidentiality</td>
<td dir="ltr">Encrypt sensitive data at rest by using service certificates.</td>
</tr>
<tr>
<td dir="ltr">Denial of service</td>
<td dir="ltr">Availability</td>
<td dir="ltr">Monitor performance metrics for potential denial-of-service conditions. Implement connection filters.</td>
</tr>
<tr>
<td dir="ltr">Elevation of privilege</td>
<td dir="ltr">Authorization</td>
<td dir="ltr">Use Privileged Identity Management.</td>
</tr>
</tbody>
</table></div></div></div></div></div></div></div><div class="el-h1 heading-wrapper"><h1 data-heading="**Monitor network security by using Network Watcher, including network security groups**" dir="auto" class="heading" id="**Monitor_network_security_by_using_Network_Watcher,_including_network_security_groups**"><strong>Monitor network security by using Network Watcher, including network security groups</strong></h1><div class="heading-children"><div class="el-p"><p dir="auto">Azure Network Watcher provides a suite of tools to monitor, diagnose, view metrics, and enable or disable logs for Azure IaaS (Infrastructure-as-a-Service) resources</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">Network Watcher enables you to monitor and repair the network health of IaaS products like virtual machines (VMs), virtual networks (VNets), application gateways, load balancers, etc.</li>
</ul></div><div class="el-h3 heading-wrapper"><h3 data-heading="3 Major sets of tools and capabilities:" dir="auto" class="heading" id="3_Major_sets_of_tools_and_capabilities:"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>3 Major sets of tools and capabilities:</h3><div class="heading-children"><div class="el-ul"><ul>
<li data-line="0" dir="auto">Monitoring</li>
<li data-line="1" dir="auto">Network diagnostic tools</li>
<li data-line="2" dir="auto">Traffic</li>
</ul></div><div class="el-p"><p dir="auto"><span alt="azure9.png" src="azure9.png" class="internal-embed media-embed image-embed is-loaded"><img alt="azure9.png" src="lib/media/azure9.png"></span></p></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="Diagnostic tools" dir="auto" class="heading" id="Diagnostic_tools"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Diagnostic tools</h3><div class="heading-children"><div class="el-ul"><ul>
<li data-line="0" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>IP flow verify
<ul>
<li data-line="1" dir="auto">allows detection of traffic filtering issues at vm level</li>
<li data-line="2" dir="auto">checks if packets is allowed or denied to or from an IP address</li>
<li data-line="3" dir="auto">indicates which security rule allowed or denied the traffic</li>
</ul>
</li>
<li data-line="4" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>NSG diagnostics
<ul>
<li data-line="5" dir="auto">detects traffic filtering issues at vm, vm scale set, or application gateway level</li>
<li data-line="6" dir="auto">checks if packet is allowed or denied to or from an IP address, IP prefix or service tag</li>
<li data-line="7" dir="auto">indicates which security rule allowed or denied traffic</li>
<li data-line="8" dir="auto">allow addition of new security rule with higher priority to allow or deny traffic</li>
</ul>
</li>
<li data-line="9" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Next hop
<ul>
<li data-line="10" dir="auto">allows detection of routing issues</li>
<li data-line="11" dir="auto">checks if traffic is routed correctly to the intended destination</li>
<li data-line="12" dir="auto">provides information about Next hop type, IP address, and Route table ID for destination IP</li>
</ul>
</li>
<li data-line="13" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Effective security rules
<ul>
<li data-line="14" dir="auto">allows visibility of security rules applied to network interface</li>
<li data-line="15" dir="auto">shows all security rules applied to network interface, subnet the network interface is in, and the aggregate of both</li>
</ul>
</li>
<li data-line="16" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Connection troubleshoot
<ul>
<li data-line="17" dir="auto">enables testing connection between vm, vm scale set, application gateway, or Bastion host and vm, an FQDN, or IPv4 address</li>
</ul>
</li>
<li data-line="18" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Packet capture
<ul>
<li data-line="19" dir="auto">allows creation of remote packet capture sessions to track traffic to and from a vm or vm scale set</li>
</ul>
</li>
<li data-line="20" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>VPN troubleshoot
<ul>
<li data-line="21" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Two traffic tools to log and visualize network traffic
<ul>
<li data-line="22" dir="auto">flow logs - Flow logs allows you to log information about your Azure IP traffic and stores the data in Azure storage.</li>
<li data-line="23" dir="auto">traffic analytics - Traffic analytics provides rich visualizations of flow logs data.</li>
</ul>
</li>
</ul>
</li>
</ul></div><div class="el-p"><p dir="auto"><span alt="azure10.png" src="azure10.png" class="internal-embed media-embed image-embed is-loaded"><img alt="azure10.png" src="lib/media/azure10.png"></span></p></div><div class="mod-footer mod-ui"></div></div></div></div></div></div></div></div><div class="sidebar-right sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="graph-view-wrapper"><div class="sidebar-section-header">Interactive Graph</div><div class="graph-view-placeholder">
		<div class="graph-view-container">
			<div class="graph-icon graph-expand" role="button" aria-label="Expand" data-tooltip-position="top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><line x1="7" y1="17" x2="17" y2="7"></line><polyline points="7 7 17 7 17 17"></polyline></svg></div>
			<canvas id="graph-canvas" class="hide" width="512px" height="512px"></canvas>
		</div>
		</div></div><div class="tree-container mod-root nav-folder tree-item outline-tree" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">Table Of Contents</span><button class="clickable-icon collapse-tree-button" aria-label="Collapse All"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-scroll-area tree-item-children nav-folder-children"><div class="tree-item mod-tree-folder nav-folder mod-collapsible is-collapsed" style="display: none;"></div><div class="tree-item" data-depth="1"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#AZ-500 Secure Networking"><div class="tree-item-contents heading-link" heading-name="AZ-500 Secure Networking"><span class="tree-item-title">AZ-500 Secure Networking</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#**What_is_an_Azure_Virtual_Network?**"><div class="tree-item-contents heading-link" heading-name="**What is an Azure Virtual Network?**"><span class="tree-item-title"><strong>What is an Azure Virtual Network?</strong></span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#Reasons_to_use_Azure_virtual_network:"><div class="tree-item-contents heading-link" heading-name="Reasons to use Azure virtual network:"><span class="tree-item-title">Reasons to use Azure virtual network:</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#**Communicate_with_the_internet**"><div class="tree-item-contents heading-link" heading-name="**Communicate with the internet**"><span class="tree-item-title"><strong>Communicate with the internet</strong></span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#**Communicate_between_Azure_resources**"><div class="tree-item-contents heading-link" heading-name="**Communicate between Azure resources**"><span class="tree-item-title"><strong>Communicate between Azure resources</strong></span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#**Communicate_with_on-premises_resources**"><div class="tree-item-contents heading-link" heading-name="**Communicate with on-premises resources**"><span class="tree-item-title"><strong>Communicate with on-premises resources</strong></span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#Network_traffic"><div class="tree-item-contents heading-link" heading-name="Network traffic"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Network traffic</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#Filter_network_traffic"><div class="tree-item-contents heading-link" heading-name="Filter network traffic"><span class="tree-item-title">Filter network traffic</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#Route_network_traffic"><div class="tree-item-contents heading-link" heading-name="Route network traffic"><span class="tree-item-title">Route network traffic</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#**Integrate_with_Azure_services**"><div class="tree-item-contents heading-link" heading-name="**Integrate with Azure services**"><span class="tree-item-title"><strong>Integrate with Azure services</strong></span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#**Plan_and_implement_Network_Security_Groups_(NSGs)_and_Application_Security_Groups_(ASGs)**"><div class="tree-item-contents heading-link" heading-name="**Plan and implement Network Security Groups (NSGs) and Application Security Groups (ASGs)**"><span class="tree-item-title"><strong>Plan and implement Network Security Groups (NSGs) and Application Security Groups (ASGs)</strong></span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#**Network_Security_Groups_(NSGs)**"><div class="tree-item-contents heading-link" heading-name="**Network Security Groups (NSGs)**"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title"><strong>Network Security Groups (NSGs)</strong></span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#**Security_rules**"><div class="tree-item-contents heading-link" heading-name="**Security rules**"><span class="tree-item-title"><strong>Security rules</strong></span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#**How_network_security_groups_filter_network_traffic**"><div class="tree-item-contents heading-link" heading-name="**How network security groups filter network traffic**"><span class="tree-item-title"><strong>How network security groups filter network traffic</strong></span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#**Application_Security_Groups_(ASGs)**"><div class="tree-item-contents heading-link" heading-name="**Application Security Groups (ASGs)**"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title"><strong>Application Security Groups (ASGs)</strong></span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#Default_rules"><div class="tree-item-contents heading-link" heading-name="Default rules"><span class="tree-item-title">Default rules</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#**Plan_and_implement_User-Defined_Routes_(UDRs)**"><div class="tree-item-contents heading-link" heading-name="**Plan and implement User-Defined Routes (UDRs)**"><span class="tree-item-title"><strong>Plan and implement User-Defined Routes (UDRs)</strong></span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#**Plan_and_implement_Virtual_Wide_Area_Network,_including_secured_virtual_hub**"><div class="tree-item-contents heading-link" heading-name="**Plan and implement Virtual Wide Area Network, including secured virtual hub**"><span class="tree-item-title"><strong>Plan and implement Virtual Wide Area Network, including secured virtual hub</strong></span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#**Prerequisites**"><div class="tree-item-contents heading-link" heading-name="**Prerequisites**"><span class="tree-item-title"><strong>Prerequisites</strong></span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#**Azure_portal_or_Azure_PowerShell**"><div class="tree-item-contents heading-link" heading-name="**Azure portal or Azure PowerShell**"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title"><strong>Azure portal or Azure PowerShell</strong></span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#**Sign_in**"><div class="tree-item-contents heading-link" heading-name="**Sign in**"><span class="tree-item-title"><strong>Sign in</strong></span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#**Create_a_virtual_WAN**"><div class="tree-item-contents heading-link" heading-name="**Create a virtual WAN**"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title"><strong>Create a virtual WAN</strong></span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#**Create_the_hub_and_configure_hub_settings**"><div class="tree-item-contents heading-link" heading-name="**Create the hub and configure hub settings**"><span class="tree-item-title"><strong>Create the hub and configure hub settings</strong></span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#**Create_a_site-to-site_VPN_gateway**"><div class="tree-item-contents heading-link" heading-name="**Create a site-to-site VPN gateway**"><span class="tree-item-title"><strong>Create a site-to-site VPN gateway</strong></span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#**Create_a_site_and_connections**"><div class="tree-item-contents heading-link" heading-name="**Create a site and connections**"><span class="tree-item-title"><strong>Create a site and connections</strong></span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#**Connect_the_VPN_site_to_a_hub**"><div class="tree-item-contents heading-link" heading-name="**Connect the VPN site to a hub**"><span class="tree-item-title"><strong>Connect the VPN site to a hub</strong></span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#**Connect_a_VNet_to_your_hub**"><div class="tree-item-contents heading-link" heading-name="**Connect a VNet to your hub**"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title"><strong>Connect a VNet to your hub</strong></span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#**Create_a_virtual_network**"><div class="tree-item-contents heading-link" heading-name="**Create a virtual network**"><span class="tree-item-title"><strong>Create a virtual network</strong></span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#Add_a_connection"><div class="tree-item-contents heading-link" heading-name="Add a connection"><span class="tree-item-title">Add a connection</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#**Configure_VPN_device**"><div class="tree-item-contents heading-link" heading-name="**Configure VPN device**"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title"><strong>Configure VPN device</strong></span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#**Download_VPN_configuration**"><div class="tree-item-contents heading-link" heading-name="**Download VPN configuration**"><span class="tree-item-title"><strong>Download VPN configuration</strong></span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#**VPN_device_configuration_file**"><div class="tree-item-contents heading-link" heading-name="**VPN device configuration file**"><span class="tree-item-title"><strong>VPN device configuration file</strong></span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#**Example_device_configuration_file**"><div class="tree-item-contents heading-link" heading-name="**Example device configuration file**"><span class="tree-item-title"><strong>Example device configuration file</strong></span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#View_or_edit_gateway_settings"><div class="tree-item-contents heading-link" heading-name="View or edit gateway settings"><span class="tree-item-title">View or edit gateway settings</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#Secure_VPN_connectivity"><div class="tree-item-contents heading-link" heading-name="Secure VPN connectivity"><span class="tree-item-title">Secure VPN connectivity</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#Site-to-Site_VPN"><div class="tree-item-contents heading-link" heading-name="Site-to-Site VPN"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Site-to-Site VPN</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#Connection_is_over_IPsec/IKE(IKEv1_or_IKEv2)_VPN_tunnel"><div class="tree-item-contents heading-link" heading-name="Connection is over IPsec/IKE(IKEv1 or IKEv2) VPN tunnel"><span class="tree-item-title">Connection is over IPsec/IKE(IKEv1 or IKEv2) VPN tunnel</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#For_creating_a_connection_to_multiple_on-premises_sites"><div class="tree-item-contents heading-link" heading-name="For creating a connection to multiple on-premises sites"><span class="tree-item-title">For creating a connection to multiple on-premises sites</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#**Point-to-site_Virtual_Private_Network**"><div class="tree-item-contents heading-link" heading-name="**Point-to-site Virtual Private Network**"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title"><strong>Point-to-site Virtual Private Network</strong></span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#Secure_connection_to_virtual_network_from_an_individual_client_computer"><div class="tree-item-contents heading-link" heading-name="Secure connection to virtual network from an individual client computer"><span class="tree-item-title">Secure connection to virtual network from an individual client computer</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#**VNet-to-VNet_connections_(Internet_Protocol_Secure/Internet_Key_Exchange_Virtual_Private_Network_Tunnel)**"><div class="tree-item-contents heading-link" heading-name="**VNet-to-VNet connections (Internet Protocol Secure/Internet Key Exchange Virtual Private Network Tunnel)**"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title"><strong>VNet-to-VNet connections (Internet Protocol Secure/Internet Key Exchange Virtual Private Network Tunnel)</strong></span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#**Connections_between_deployment_models**"><div class="tree-item-contents heading-link" heading-name="**Connections between deployment models**"><span class="tree-item-title"><strong>Connections between deployment models</strong></span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#Azure_ExpressRoute"><div class="tree-item-contents heading-link" heading-name="Azure ExpressRoute"><span class="tree-item-title">Azure ExpressRoute</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#Key_Benefits"><div class="tree-item-contents heading-link" heading-name="Key Benefits"><span class="tree-item-title">Key Benefits</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#Features"><div class="tree-item-contents heading-link" heading-name="Features"><span class="tree-item-title">Features</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#Redundancy"><div class="tree-item-contents heading-link" heading-name="Redundancy"><span class="tree-item-title">Redundancy</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#Flexible_billing_models"><div class="tree-item-contents heading-link" heading-name="Flexible billing models"><span class="tree-item-title">Flexible billing models</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#**Implement_encryption_over_ExpressRoute**"><div class="tree-item-contents heading-link" heading-name="**Implement encryption over ExpressRoute**"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title"><strong>Implement encryption over ExpressRoute</strong></span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#**Traffic_from_on-premises_networks_to_Azure**"><div class="tree-item-contents heading-link" heading-name="**Traffic from on-premises networks to Azure**"><span class="tree-item-title"><strong>Traffic from on-premises networks to Azure</strong></span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#**Traffic_from_Azure_to_on-premises_networks**"><div class="tree-item-contents heading-link" heading-name="**Traffic from Azure to on-premises networks**"><span class="tree-item-title"><strong>Traffic from Azure to on-premises networks</strong></span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#Lab:_Configuring_VPN_ExpressRoute_Connection"><div class="tree-item-contents heading-link" heading-name="Lab: Configuring VPN ExpressRoute Connection"><span class="tree-item-title">Lab: Configuring VPN ExpressRoute Connection</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="2"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#Before_you_begin"><div class="tree-item-contents heading-link" heading-name="Before you begin"><span class="tree-item-title">Before you begin</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#1._Create_a_virtual_WAN_and_hub_with_gateways"><div class="tree-item-contents heading-link" heading-name="1. Create a virtual WAN and hub with gateways"><span class="tree-item-title">1. 
Create a virtual WAN and hub with gateways
</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#2._Create_a_site_for_the_on-premises_network"><div class="tree-item-contents heading-link" heading-name="2. Create a site for the on-premises network"><span class="tree-item-title">2. 
Create a site for the on-premises network
</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#3._Update_the_VPN_connection_setting_to_use_ExpressRoute"><div class="tree-item-contents heading-link" heading-name="3. Update the VPN connection setting to use ExpressRoute"><span class="tree-item-title">3. 
Update the VPN connection setting to use ExpressRoute
</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#4._Get_the_private_IP_addresses_for_the_hub_VPN_gateway"><div class="tree-item-contents heading-link" heading-name="4. Get the private IP addresses for the hub VPN gateway"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">4. 
Get the private IP addresses for the hub VPN gateway
</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#VPN_device_configuration_file"><div class="tree-item-contents heading-link" heading-name="VPN device configuration file"><span class="tree-item-title">VPN device configuration file</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#Configuring_your_VPN_device"><div class="tree-item-contents heading-link" heading-name="Configuring your VPN device"><span class="tree-item-title">Configuring your VPN device</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#5._View_your_virtual_WAN"><div class="tree-item-contents heading-link" heading-name="5. View your virtual WAN"><span class="tree-item-title">5. 
View your virtual WAN
</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#6._Monitor_a_connection"><div class="tree-item-contents heading-link" heading-name="6. Monitor a connection"><span class="tree-item-title">6. 
Monitor a connection
</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#Configure_firewall_settings_on_PaaS_resources"><div class="tree-item-contents heading-link" heading-name="Configure firewall settings on PaaS resources"><span class="tree-item-title">Configure firewall settings on PaaS resources</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#**Cloud_security_advantages**"><div class="tree-item-contents heading-link" heading-name="**Cloud security advantages**"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title"><strong>Cloud security advantages</strong></span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#**Security_advantages_of_a_PaaS_cloud_service_model**"><div class="tree-item-contents heading-link" heading-name="**Security advantages of a PaaS cloud service model**"><span class="tree-item-title"><strong>Security advantages of a PaaS cloud service model</strong></span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#**Adopt_a_policy_of_identity_as_the_primary_security_perimeter**"><div class="tree-item-contents heading-link" heading-name="**Adopt a policy of identity as the primary security perimeter**"><span class="tree-item-title"><strong>Adopt a policy of identity as the primary security perimeter</strong></span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#**Use_threat_modeling_during_application_design**"><div class="tree-item-contents heading-link" heading-name="**Use threat modeling during application design**"><span class="tree-item-title"><strong>Use threat modeling during application design</strong></span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#**Monitor_network_security_by_using_Network_Watcher,_including_network_security_groups**"><div class="tree-item-contents heading-link" heading-name="**Monitor network security by using Network Watcher, including network security groups**"><span class="tree-item-title"><strong>Monitor network security by using Network Watcher, including network security groups</strong></span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#3_Major_sets_of_tools_and_capabilities:"><div class="tree-item-contents heading-link" heading-name="3 Major sets of tools and capabilities:"><span class="tree-item-title">3 Major sets of tools and capabilities:</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="microsoft\az-series\az-500-secure-networking.html#Diagnostic_tools"><div class="tree-item-contents heading-link" heading-name="Diagnostic tools"><span class="tree-item-title">Diagnostic tools</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div></div></div></div><script defer="">let rs = document.querySelector(".sidebar-right"); rs.classList.add("is-collapsed"); if (window.innerWidth > 768) rs.classList.remove("is-collapsed"); rs.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-right-width"));</script></div></div></body></html>